<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.18.1 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Tractor - Kyle Amyx</title>
<meta name="description" content="Data Science Portfolio ">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Kyle Amyx">
<meta property="og:title" content="Tractor">
<meta property="og:url" content="http://localhost:4000/tractor/2020-03-09-tractor/">


  <meta property="og:description" content="Data Science Portfolio ">







  <meta property="article:published_time" content="2020-11-05T00:00:00-05:00">





  

  


<link rel="canonical" href="http://localhost:4000/tractor/2020-03-09-tractor/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Kyle Amyx",
      "url": "http://localhost:4000/"
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Kyle Amyx Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/osu_logo_small.png" alt=""></a>
        
        <a class="site-title" href="/">
          Kyle Amyx
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/about/" >About</a>
            </li><li class="masthead__menu-item">
              <a href="/datascience/" >Data science</a>
            </li><li class="masthead__menu-item">
              <a href="/android/" >Mobile Dev</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name"></h3>
    
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Tractor">
    
    <meta itemprop="datePublished" content="2020-11-05T00:00:00-05:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Tractor
</h1>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <ul>
  <li>
    <p>Tractor/VAM Plots &amp; Models:
<br />
<a href="#ohio-tractor-vam-plots">Ohio</a>
<br />
<a href="#michigan-tractor-vam-plots">Michigan</a>
<br />
<a href="#wisconsin-tractor-vam-plots">Wisconsin</a>
<br />
<a href="#indiana-tractor-vam-plots">Indiana</a>
<br />
<a href="#illinois-tractor-vam-plots">Illinois</a>
<br />
<a href="#iowa-tractor-vam-plots">Iowa</a></p>
  </li>
  <li>
    <p><a href="#vam-regression">VAM Regression</a></p>
  </li>
</ul>

<p>Note about VAM Plots: Any counties with <code class="highlighter-rouge">N/A</code> value for VAM were replaced with 0. These are so few that I believe it has minimal effect on the trend lines.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#Function for producing EDU dataset</span><span class="w">
</span><span class="c1">#</span><span class="w">
</span><span class="c1">#</span><span class="w">
</span><span class="n">eduDataFunc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">state</span><span class="p">){</span><span class="w">
  </span><span class="n">edu_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">oth_state</span><span class="p">,</span><span class="w"> </span><span class="n">stateicp</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">state</span><span class="p">)</span><span class="w">
  </span><span class="n">edu_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">edu_data</span><span class="p">,</span><span class="w"> </span><span class="n">sex</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Male"</span><span class="p">)</span><span class="w">
  </span><span class="n">edu_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">edu_data</span><span class="p">,</span><span class="w"> </span><span class="n">between</span><span class="p">(</span><span class="n">age</span><span class="p">,</span><span class="w"> </span><span class="m">18</span><span class="p">,</span><span class="m">22</span><span class="p">))</span><span class="w">
  </span><span class="n">edu_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">edu_data</span><span class="p">,</span><span class="w"> </span><span class="n">higrade</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">20</span><span class="p">)</span><span class="w">
  </span><span class="n">edu_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">edu_data</span><span class="p">,</span><span class="w"> </span><span class="n">higrade</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w">
  </span><span class="n">edu_data</span><span class="o">$</span><span class="n">higrade</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">edu_data</span><span class="o">$</span><span class="n">higrade</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">3</span><span class="w">
  
  </span><span class="n">reduced_edu_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">edu_data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">group_by</span><span class="p">(</span><span class="n">county</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">summarise</span><span class="p">(</span><span class="n">avg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">higrade</span><span class="p">))</span><span class="w">
  
  </span><span class="nf">return</span><span class="p">(</span><span class="n">reduced_edu_data</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="c1">#</span><span class="w">
</span><span class="c1">#</span><span class="w">
</span><span class="c1">#</span><span class="w">

</span><span class="n">eduMedianFunc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">state</span><span class="p">){</span><span class="w">
  </span><span class="n">edu_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">oth_state</span><span class="p">,</span><span class="w"> </span><span class="n">stateicp</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">state</span><span class="p">)</span><span class="w">
  </span><span class="n">edu_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">edu_data</span><span class="p">,</span><span class="w"> </span><span class="n">sex</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Male"</span><span class="p">)</span><span class="w">
  </span><span class="n">edu_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">edu_data</span><span class="p">,</span><span class="w"> </span><span class="n">between</span><span class="p">(</span><span class="n">age</span><span class="p">,</span><span class="w"> </span><span class="m">18</span><span class="p">,</span><span class="m">22</span><span class="p">))</span><span class="w">
  </span><span class="n">edu_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">edu_data</span><span class="p">,</span><span class="w"> </span><span class="n">higrade</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">20</span><span class="p">)</span><span class="w">
  </span><span class="n">edu_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">edu_data</span><span class="p">,</span><span class="w"> </span><span class="n">higrade</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w">
  </span><span class="n">edu_data</span><span class="o">$</span><span class="n">higrade</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">edu_data</span><span class="o">$</span><span class="n">higrade</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">3</span><span class="w">
  
  </span><span class="n">reduced_edu_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">edu_data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">group_by</span><span class="p">(</span><span class="n">county</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">summarise</span><span class="p">(</span><span class="n">med</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">median</span><span class="p">(</span><span class="n">higrade</span><span class="p">))</span><span class="w">
  
  </span><span class="nf">return</span><span class="p">(</span><span class="n">reduced_edu_data</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">


</span><span class="c1">#Function for producing Tractor set given State Abb</span><span class="w">
</span><span class="c1">#</span><span class="w">
</span><span class="c1">#</span><span class="w">
</span><span class="n">tractDataFunc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">stateAbbre</span><span class="p">){</span><span class="w">
  </span><span class="n">stateDf</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">df30</span><span class="p">,</span><span class="w"> </span><span class="n">stateAbb</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">stateAbbre</span><span class="p">)</span><span class="w">
  </span><span class="n">stateDf</span><span class="o">$</span><span class="n">county</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">stateDf</span><span class="o">$</span><span class="n">county</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">10</span><span class="w">
  </span><span class="n">stateDf</span><span class="o">$</span><span class="n">X</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NULL</span><span class="w">
  </span><span class="nf">return</span><span class="p">(</span><span class="n">stateDf</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="c1">#</span><span class="w">
</span><span class="c1">#</span><span class="w">
</span><span class="c1">#</span><span class="w">
</span></code></pre></div></div>

<hr />

<p>#National Level</p>

<p>Looking at the national level of percent of farms with tractors over varying years. The percentages are measured on the county level.</p>

<h2 id="-farm-tractor-1940-vs-1930">% Farm Tractor 1940 vs 1930</h2>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df30_40</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">merge</span><span class="p">(</span><span class="n">df30</span><span class="p">,</span><span class="w"> </span><span class="n">df40</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"name"</span><span class="p">,</span><span class="w"> </span><span class="s2">"stateAbb"</span><span class="p">),</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df30_40</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">percent_farm_tractor.x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">percent_farm_tractor.y</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xlab</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"% of Farms w/ Tractors 1930's"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ylab</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"% of Farms w/ Tractors 1940's"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"National Level"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/nationalTractor1940v1930-1.png" alt="" /><!-- --></p>

<h2 id="-farm-tractor-1950-vs-1940">% Farm Tractor 1950 vs 1940</h2>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df40_50</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">merge</span><span class="p">(</span><span class="n">df40</span><span class="p">,</span><span class="w"> </span><span class="n">df50</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"name"</span><span class="p">,</span><span class="w"> </span><span class="s2">"stateAbb"</span><span class="p">),</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df40_50</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">percent_farm_tractor.x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">percent_farm_tractor.y</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xlab</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"% of Farms w/ Tractors 1940's"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ylab</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"% of Farms w/ Tractors 1950's"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"National Level"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/nationalTractor1950v1940-1.png" alt="" /><!-- --></p>

<h2 id="-farm-tractor-1954-vs-1950">% Farm Tractor 1954 vs 1950</h2>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df50_54</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">merge</span><span class="p">(</span><span class="n">df50</span><span class="p">,</span><span class="w"> </span><span class="n">df54</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"name"</span><span class="p">,</span><span class="w"> </span><span class="s2">"stateAbb"</span><span class="p">),</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df50_54</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">percent_farm_tractor.x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">percent_farm_tractor.y</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xlab</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"% of Farms w/ Tractors 1950"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ylab</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"% of Farms w/ Tractors 1954"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"National Level"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/nationalTractor1954v1950-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df50_54</span><span class="o">$</span><span class="n">logResponse</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">log</span><span class="p">(</span><span class="n">df50_54</span><span class="o">$</span><span class="n">percent_farm_tractor.y</span><span class="p">)</span><span class="w">
</span><span class="n">df50_54</span><span class="o">$</span><span class="n">logX</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">log</span><span class="p">(</span><span class="n">df50_54</span><span class="o">$</span><span class="n">percent_farm_tractor.x</span><span class="p">)</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df50_54</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">percent_farm_tractor.x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">logResponse</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xlab</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"% of Farms w/ Tractors 1950"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ylab</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Log(% of Farms w/ Tractors 1954)"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"National Level"</span><span class="p">)</span><span class="w"> 
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/nationalTractor1954v1950-2.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df50_54</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">logX</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">logResponse</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xlab</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Log(% of Farms w/ Tractors 1950)"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ylab</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Log(% of Farms w/ Tractors 1954)"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"National Level"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/nationalTractor1954v1950-3.png" alt="" /><!-- --></p>

<h2 id="-farm-tractor-1964-vs-1954">% Farm Tractor 1964 vs 1954</h2>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df54_64</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">merge</span><span class="p">(</span><span class="n">df54</span><span class="p">,</span><span class="w"> </span><span class="n">df64</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"name"</span><span class="p">,</span><span class="w"> </span><span class="s2">"stateAbb"</span><span class="p">),</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df54_64</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">percent_farm_tractor.x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">percent_farm_tractor.y</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xlab</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"% of Farms w/ Tractors 1954"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ylab</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"% of Farms w/ Tractors 1964"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"National Level"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/nationalTractor1964v1954-1.png" alt="" /><!-- --></p>

<hr />

<h1 id="ohio">OHIO<a id="ohio-tractor-vam-plots"></a></h1>

<p><a href="#ohio-mean-edu-model">Mean Edu vs. Tractor</a><br />
<br />
<a href="#ohio-median-edu-model">Median Edu vs. Tractor</a><br />
<br />
<a href="#ohio-vam">Value Added by Manufacturing</a><br />
<br /></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">edu</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.dta13</span><span class="p">(</span><span class="s2">"ohio1940.dta"</span><span class="p">)</span><span class="w">

</span><span class="n">ohio1930</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">df30</span><span class="p">,</span><span class="w"> </span><span class="n">stateAbb</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"OH"</span><span class="p">)</span><span class="w">
</span><span class="c1">#Adjust FIPS code representation to match the EDU dataset</span><span class="w">
</span><span class="n">ohio1930</span><span class="o">$</span><span class="n">county</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ohio1930</span><span class="o">$</span><span class="n">county</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">10</span><span class="w">
</span><span class="c1">#Remove Pickaway</span><span class="w">
</span><span class="n">ohio1930</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">ohio1930</span><span class="p">,</span><span class="w"> </span><span class="n">county</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="m">129</span><span class="p">)</span><span class="w">

</span><span class="c1">#SUBSET to White males between 18,22 and higrade &lt; 20 which would be graduate school</span><span class="w">
</span><span class="n">edu</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">edu</span><span class="p">,</span><span class="w"> </span><span class="n">sex</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Male"</span><span class="p">)</span><span class="w">
</span><span class="n">edu</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">edu</span><span class="p">,</span><span class="w"> </span><span class="n">between</span><span class="p">(</span><span class="n">age</span><span class="p">,</span><span class="w"> </span><span class="m">18</span><span class="p">,</span><span class="w"> </span><span class="m">22</span><span class="p">))</span><span class="w">
</span><span class="n">edu</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">edu</span><span class="p">,</span><span class="w"> </span><span class="n">higrade</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">20</span><span class="p">)</span><span class="w">
</span><span class="n">edu</span><span class="o">$</span><span class="n">higrade</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">edu</span><span class="o">$</span><span class="n">higrade</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">3</span><span class="w">

</span><span class="c1">#Remove all values less than 1</span><span class="w">
</span><span class="n">edu</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">edu</span><span class="p">[</span><span class="n">which</span><span class="p">(</span><span class="n">edu</span><span class="o">$</span><span class="n">higrade</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">),]</span><span class="w">


</span><span class="c1">#THIS IS FINAL 1940 EDU, write out to new dataset </span><span class="w">
</span><span class="n">write.csv</span><span class="p">(</span><span class="n">edu</span><span class="p">,</span><span class="w"> </span><span class="s2">"ohio1940edu.csv"</span><span class="p">)</span><span class="w">


</span><span class="n">newEdu</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">edu</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">county</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarise</span><span class="p">(</span><span class="n">avg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">higrade</span><span class="p">))</span><span class="w">

</span><span class="n">ohPlotSrc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">merge</span><span class="p">(</span><span class="n">newEdu</span><span class="p">,</span><span class="w"> </span><span class="n">ohio1930</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"county"</span><span class="p">)</span><span class="w">

</span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ohPlotSrc</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">avg</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="n">xlab</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"% Farms w/ Tractors 1930"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ylab</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Avg Years Education"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Ohio"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/Ohio1940AvgEduv1930Tractor-1.png" alt="" /><!-- --></p>

<h2 id="loess-regression-on-1940s-avg-edu-vs--farms-w-tractor-1930s-for-ohio">LOESS REGRESSION on 1940’s Avg EDU vs % Farms w/ Tractor 1930’s for Ohio</h2>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ggplot</span><span class="p">(</span><span class="n">ohPlotSrc</span><span class="p">,</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">()</span><span class="w">  </span><span class="o">+</span><span class="w"> </span><span class="n">geom_smooth</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xlab</span><span class="p">(</span><span class="s2">"1930's % Farms w/ Tractors"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ylab</span><span class="p">(</span><span class="s2">"1940's Edu"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Ohio"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## `geom_smooth()` using method = 'loess' and formula 'y ~ x'
</code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/ohEduVsTractorLoess-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#identify(ohio1930$percent_farm_tractor, newEdu$avg)</span><span class="w">
</span></code></pre></div></div>

<p>##Transform ohio edu response on Log Scale</p>
<h3 id="ohio-mean-education-model">Ohio Mean Education Model<a id="ohio-mean-edu-model"></a></h3>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ohPlotSrc</span><span class="o">$</span><span class="n">logAvg</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">log</span><span class="p">(</span><span class="n">ohPlotSrc</span><span class="o">$</span><span class="n">avg</span><span class="p">)</span><span class="w">

</span><span class="n">ohEduMod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">logAvg</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ohPlotSrc</span><span class="p">)</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ohPlotSrc</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">logAvg</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_smooth</span><span class="p">(</span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"lm"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xlab</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"% Farms Tractor 1930's"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ylab</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Log(Avg Education 1940's)"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Log-Linear(Ohio Edu vs Tractor)"</span><span class="p">)</span><span class="w"> 
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## `geom_smooth()` using formula 'y ~ x'
</code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/ohLog1940EduMeanv1930Tractor-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">summary</span><span class="p">(</span><span class="n">ohEduMod</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## 
## Call:
## lm(formula = logAvg ~ percent_farm_tractor, data = ohPlotSrc)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.121748 -0.021526  0.008973  0.029746  0.066242 
## 
## Coefficients:
##                      Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)          2.280754   0.009254 246.458  &lt; 2e-16 ***
## percent_farm_tractor 0.186915   0.035457   5.272 9.92e-07 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.04027 on 86 degrees of freedom
## Multiple R-squared:  0.2442,	Adjusted R-squared:  0.2354 
## F-statistic: 27.79 on 1 and 86 DF,  p-value: 9.92e-07
</code></pre></div></div>

<h3 id="ohio---median-education-plots">Ohio - Median Education Plots<a id="ohio-median-edu-model"></a></h3>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">eduMedian</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">edu</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">county</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarise</span><span class="p">(</span><span class="n">med</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">median</span><span class="p">(</span><span class="n">higrade</span><span class="p">))</span><span class="w">
</span><span class="c1"># Log of Education Median</span><span class="w">
</span><span class="n">eduMedian</span><span class="o">$</span><span class="n">logMed</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">log</span><span class="p">(</span><span class="n">eduMedian</span><span class="o">$</span><span class="n">med</span><span class="p">)</span><span class="w">

</span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ohio1930</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">jitter</span><span class="p">(</span><span class="n">percent_farm_tractor</span><span class="p">),</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">jitter</span><span class="p">(</span><span class="n">eduMedian</span><span class="o">$</span><span class="n">med</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xlab</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"% Farms w/ Tractors 1930's"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ylab</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"1940's Median Avg. Education"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/ohEduMedianv1930TractorPlots-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ohio1930</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">jitter</span><span class="p">(</span><span class="n">percent_farm_tractor</span><span class="p">),</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">jitter</span><span class="p">(</span><span class="n">eduMedian</span><span class="o">$</span><span class="n">logMed</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xlab</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"% Farms w/ Tractors 1930's"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ylab</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"1940's Median Avg. Education"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/ohEduMedianv1930TractorPlots-2.png" alt="" /><!-- --></p>

<h3 id="ohio---median-education-model">Ohio - Median Education Model</h3>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ohPlotSrc_med</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">merge</span><span class="p">(</span><span class="n">eduMedian</span><span class="p">,</span><span class="w"> </span><span class="n">ohio1930</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"county"</span><span class="p">)</span><span class="w">
</span><span class="n">ohEduMod_med</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">logMed</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ohPlotSrc_med</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">ohEduMod_med</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## 
## Call:
## lm(formula = logMed ~ percent_farm_tractor, data = ohPlotSrc_med)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.23988 -0.01976  0.01381  0.03978  0.09668 
## 
## Coefficients:
##                      Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           2.29588    0.01401 163.899   &lt;2e-16 ***
## percent_farm_tractor  0.24231    0.05367   4.515    2e-05 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.06095 on 86 degrees of freedom
## Multiple R-squared:  0.1916,	Adjusted R-squared:  0.1822 
## F-statistic: 20.38 on 1 and 86 DF,  p-value: 2.002e-05
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">oh_med_df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as.data.frame</span><span class="p">(</span><span class="n">resid</span><span class="p">(</span><span class="n">ohEduMod_med</span><span class="p">))</span><span class="w">
</span><span class="n">oh_med_df</span><span class="o">$</span><span class="n">county</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ohPlotSrc_med</span><span class="o">$</span><span class="n">name</span><span class="w">
</span><span class="n">colnames</span><span class="p">(</span><span class="n">oh_med_df</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="w"> </span><span class="s2">"residual"</span><span class="p">,</span><span class="w"> </span><span class="s2">"county"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<h3 id="ohio-median-model-county-residuals">Ohio Median Model County Residuals</h3>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">head</span><span class="p">(</span><span class="n">oh_med_df</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>##      residual    county
## 1 -0.11295981     ADAMS
## 2  0.04748636     ALLEN
## 3  0.05497776   ASHLAND
## 4  0.04637276 ASHTABULA
## 5  0.08549094    ATHENS
## 6  0.02526599  AUGLAIZE
</code></pre></div></div>

<h2 id="oh-edu-vs--farms-w-tractors-sse">OH EDU VS % Farm’s w/ Tractors S.S.E.</h2>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#Calculate SSE</span><span class="w">
</span><span class="n">pred_ohEdu</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">ohEduMod</span><span class="p">,</span><span class="w"> </span><span class="n">ohPlotSrc</span><span class="p">)</span><span class="w">
</span><span class="c1">#Undo log transformation</span><span class="w">
</span><span class="n">pred_ohEdu</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">pred_ohEdu</span><span class="p">)</span><span class="m">-1</span><span class="w">

</span><span class="c1">##Sum of Square error</span><span class="w">
</span><span class="n">mean</span><span class="p">((</span><span class="n">ohPlotSrc</span><span class="o">$</span><span class="n">avg</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pred_ohEdu</span><span class="p">)</span><span class="o">^</span><span class="m">2</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] 1.174032
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#Residuals</span><span class="w">
</span><span class="n">ohPlotSrc</span><span class="o">$</span><span class="n">modResid</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">resid</span><span class="p">(</span><span class="n">ohEduMod</span><span class="p">)</span><span class="w">
</span><span class="n">ohPlotSrc</span><span class="o">$</span><span class="n">fitted</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">ohEduMod</span><span class="p">)</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">ohPlotSrc</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fitted</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">modResid</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_hline</span><span class="p">(</span><span class="n">yintercept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"red"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"OH Edu vs Tractor Residuals"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/ohEduvTractorSSE-1.png" alt="" /><!-- --></p>

<h1 id="ohio-value-added-by-manufacturing">OHIO Value Added by Manufacturing<a id="ohio-vam"></a></h1>
<h2 id="vam-1947-vs--1940">VAM 1947 vs % 1940</h2>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#SCATTER DIAGRAM AND REGRESSION FOR OHIO VAM VS EDU</span><span class="w">
</span><span class="c1">#VAM dataset</span><span class="w">
</span><span class="n">vam_ohio</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">vam</span><span class="p">,</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Ohio"</span><span class="p">)</span><span class="w">
</span><span class="c1">#write.csv(vam_ohio, "vamOhio.csv")</span><span class="w">

</span><span class="c1">#VAM in 1947 vs % Tractors 1940</span><span class="w">
</span><span class="n">vam_ohio</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">vam_ohio</span><span class="p">,</span><span class="w"> </span><span class="n">year</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1947</span><span class="p">)</span><span class="w">
</span><span class="n">ohio1940</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">df40</span><span class="p">,</span><span class="w"> </span><span class="n">stateAbb</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"OH"</span><span class="p">)</span><span class="w">
</span><span class="n">ohio1930</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">df30</span><span class="p">,</span><span class="w"> </span><span class="n">stateAbb</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"OH"</span><span class="p">)</span><span class="w">
</span><span class="n">ohio1940</span><span class="o">$</span><span class="n">county</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ohio1940</span><span class="o">$</span><span class="n">county</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">10</span><span class="w">

</span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ohio1940</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">vam_ohio</span><span class="o">$</span><span class="n">VAM</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xlab</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"% Farm's w/ Tractors 1940"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ylab</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"VAM 1947"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Ohio VAM vs. % Tractor"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_smooth</span><span class="p">(</span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"lm"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## `geom_smooth()` using formula 'y ~ x'
</code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/ohVAM1947v1940-1.png" alt="" /><!-- --></p>

<h2 id="vam-1958-vs--1950">VAM 1958 vs % 1950</h2>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ohio1950</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">df50</span><span class="p">,</span><span class="n">stateAbb</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"OH"</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="n">vam_ohio1957</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">vam</span><span class="p">,</span><span class="w"> </span><span class="n">year</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1958</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Ohio"</span><span class="p">)</span><span class="w">
</span><span class="n">ohVam_mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">vam_ohio1957</span><span class="o">$</span><span class="n">VAM</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">ohio1950</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">ohVam_mod</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## 
## Call:
## lm(formula = vam_ohio1957$VAM ~ ohio1950$percent_farm_tractor)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -569.63 -189.42  -25.26  194.35  616.99 
## 
## Coefficients:
##                               Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)                      188.7      119.4   1.581  0.11950   
## ohio1950$percent_farm_tractor    546.8      188.4   2.902  0.00526 **
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 273.3 on 57 degrees of freedom
##   (29 observations deleted due to missingness)
## Multiple R-squared:  0.1288,	Adjusted R-squared:  0.1135 
## F-statistic: 8.424 on 1 and 57 DF,  p-value: 0.005256
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ohio1950</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">vam_ohio1957</span><span class="o">$</span><span class="n">VAM</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xlab</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"% Farm's w/ Tractors 1950"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ylab</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"VAM 1958"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Ohio VAM vs. % Tractor"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_smooth</span><span class="p">(</span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"lm"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## `geom_smooth()` using formula 'y ~ x'
</code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/ohVAM1958v1950-1.png" alt="" /><!-- --></p>

<h2 id="vam-1947-vs--1930">VAM 1947 vs % 1930</h2>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ohVam_mod1947</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">vam_ohio</span><span class="o">$</span><span class="n">VAM</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">ohio1930</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">ohVam_mod1947</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## 
## Call:
## lm(formula = vam_ohio$VAM ~ ohio1930$percent_farm_tractor)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -447.78 -210.40  -43.62  235.08  562.43 
## 
## Coefficients:
##                               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                     214.00      62.37   3.431 0.000959 ***
## ohio1930$percent_farm_tractor   827.97     240.82   3.438 0.000938 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 269.5 on 79 degrees of freedom
##   (7 observations deleted due to missingness)
## Multiple R-squared:  0.1302,	Adjusted R-squared:  0.1191 
## F-statistic: 11.82 on 1 and 79 DF,  p-value: 0.0009376
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ohio1930</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">vam_ohio</span><span class="o">$</span><span class="n">VAM</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xlab</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"% Farm's w/ Tractors 1930"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ylab</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"VAM 1947"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Ohio VAM vs. % Tractor"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_smooth</span><span class="p">(</span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"lm"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## `geom_smooth()` using formula 'y ~ x'
</code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/ohVAM1947v1930-1.png" alt="" /><!-- --></p>

<hr />

<p>1940 Census Dataset; Pull other midwest states from here</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># NEW DATASET! -&gt; EDU 1940 vs % Tractor 1930</span><span class="w">
</span><span class="c1">#oth_state &lt;- read.dta13("cen1940A.dta")</span><span class="w">
</span><span class="c1">#saveRDS(oth_state, "midwest_state.rds")</span><span class="w">

</span><span class="c1"># Restore the data object. Shit is huge...I was tired of loading it over and over...</span><span class="w">
</span><span class="n">oth_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">readRDS</span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"midwest_state.rds"</span><span class="p">)</span><span class="w">

</span><span class="c1">#States:</span><span class="w">
</span><span class="c1"># Michigan, Wisconsin, Indiana, Illinois, Iowa, Minnesota</span><span class="w">
</span></code></pre></div></div>

<hr />

<h1 id="michigan">MICHIGAN<a id="michigan-tractor-vam-plots"></a></h1>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] "use `stateicp` as locations\nage between 18,22\nhigrade &lt; 20"
</code></pre></div></div>

<p>#LOESS REGRESSION on EDU vs % Tractor</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ggplot</span><span class="p">(</span><span class="n">michPlotSrc</span><span class="p">,</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">()</span><span class="w">  </span><span class="o">+</span><span class="w"> </span><span class="n">geom_smooth</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xlab</span><span class="p">(</span><span class="s2">"1930's % Tractor"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ylab</span><span class="p">(</span><span class="s2">"1940 Avg. Edu"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Michigan"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## `geom_smooth()` using method = 'loess' and formula 'y ~ x'
</code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/michiganFarmvEduLoess-1.png" alt="" /><!-- --></p>

<p>#Transform response on Log Scale</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">michPlotSrc</span><span class="o">$</span><span class="n">logAvg</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">log</span><span class="p">(</span><span class="n">michPlotSrc</span><span class="o">$</span><span class="n">avg</span><span class="p">)</span><span class="w">

</span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">michPlotSrc</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">logAvg</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Log-Linear"</span><span class="p">)</span><span class="w"> 
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-1-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">michEduMod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">logAvg</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">michPlotSrc</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">michEduMod</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## 
## Call:
## lm(formula = logAvg ~ percent_farm_tractor, data = michPlotSrc)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.219400 -0.036979  0.000761  0.041468  0.100975 
## 
## Coefficients:
##                      Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           2.25242    0.01312 171.704   &lt;2e-16 ***
## percent_farm_tractor  0.17868    0.07160   2.496   0.0146 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.05275 on 81 degrees of freedom
## Multiple R-squared:  0.07139,	Adjusted R-squared:  0.05993 
## F-statistic: 6.228 on 1 and 81 DF,  p-value: 0.01461
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#Residuals</span><span class="w">
</span><span class="n">michPlotSrc</span><span class="o">$</span><span class="n">modResid</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">resid</span><span class="p">(</span><span class="n">michEduMod</span><span class="p">)</span><span class="w">
</span><span class="n">michPlotSrc</span><span class="o">$</span><span class="n">fitted</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">michEduMod</span><span class="p">)</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">michPlotSrc</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fitted</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">modResid</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_hline</span><span class="p">(</span><span class="n">yintercept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"red"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"MI Edu vs Tractor Residuals"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-1-2.png" alt="" /><!-- --></p>

<p>#Michigan - Median</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">michMedian</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">eduMedianFunc</span><span class="p">(</span><span class="s2">"Michigan"</span><span class="p">)</span><span class="w">

</span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mich_tract</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">jitter</span><span class="p">(</span><span class="n">michMedian</span><span class="o">$</span><span class="n">med</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Michigan-Median"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-2-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">michMedian</span><span class="o">$</span><span class="n">logMed</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">log</span><span class="p">(</span><span class="n">michMedian</span><span class="o">$</span><span class="n">med</span><span class="p">)</span><span class="w">

</span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mich_tract</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">jitter</span><span class="p">(</span><span class="n">percent_farm_tractor</span><span class="p">),</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">jitter</span><span class="p">(</span><span class="n">michMedian</span><span class="o">$</span><span class="n">logMed</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xlab</span><span class="p">(</span><span class="s2">"% 1930's"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ylab</span><span class="p">(</span><span class="s2">"Log Median years education"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Michigan-Log(Median)"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-2-2.png" alt="" /><!-- --></p>

<h3 id="michigan---median-model">Michigan - Median Model</h3>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plotSrc_med_mich</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">merge</span><span class="p">(</span><span class="n">michMedian</span><span class="p">,</span><span class="w"> </span><span class="n">mich_tract</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"county"</span><span class="p">)</span><span class="w">
</span><span class="n">michEduMod_med</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">logMed</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">plotSrc_med_mich</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">michEduMod_med</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## 
## Call:
## lm(formula = logMed ~ percent_farm_tractor, data = plotSrc_med_mich)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.25098 -0.06656  0.02238  0.05473  0.14252 
## 
## Coefficients:
##                      Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           2.23574    0.02284  97.892  &lt; 2e-16 ***
## percent_farm_tractor  0.33943    0.12465   2.723  0.00792 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.09184 on 81 degrees of freedom
## Multiple R-squared:  0.08386,	Adjusted R-squared:  0.07255 
## F-statistic: 7.415 on 1 and 81 DF,  p-value: 0.007921
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mi_med_df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as.data.frame</span><span class="p">(</span><span class="n">resid</span><span class="p">(</span><span class="n">michEduMod_med</span><span class="p">))</span><span class="w">
</span><span class="n">mi_med_df</span><span class="o">$</span><span class="n">county</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">plotSrc_med_mich</span><span class="o">$</span><span class="n">name</span><span class="w">
</span><span class="n">colnames</span><span class="p">(</span><span class="n">mi_med_df</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="w"> </span><span class="s2">"residual"</span><span class="p">,</span><span class="w"> </span><span class="s2">"county"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<h3 id="michigan-median-model-county-residuals">Michigan Median Model County Residuals</h3>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mi_med_df</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>##        residual            county
## 1  -0.187275178            ALCONA
## 2  -0.085014801             ALGER
## 3   0.008819658           ALLEGAN
## 4  -0.079919458            ALPENA
## 5  -0.077488032            ANTRIM
## 6  -0.200353056            ARENAC
## 7   0.025425850            BARAGA
## 8   0.110906381             BARRY
## 9  -0.012837076               BAY
## 10  0.031026497            BENZIE
## 11  0.107743596           BERRIEN
## 12  0.008707873            BRANCH
## 13  0.111953523           CALHOUN
## 14  0.120925711              CASS
## 15  0.036165627        CHARLEVOIX
## 16 -0.065297665         CHEBOYGAN
## 17  0.020599745          CHIPPEWA
## 18  0.033014005             CLARE
## 19 -0.042063207           CLINTON
## 20  0.014172802          CRAWFORD
## 21  0.012887339             DELTA
## 22  0.101942375         DICKINSON
## 23  0.072106438             EATON
## 24 -0.066056828             EMMET
## 25  0.055198261           GENESEE
## 26 -0.069792934           GLADWIN
## 27  0.142516707           GOGEBIC
## 28  0.011545445    GRAND TRAVERSE
## 29 -0.032579808           GRATIOT
## 30  0.100856541         HILLSDALE
## 31  0.039725469          HOUGHTON
## 32 -0.250981531             HURON
## 33  0.068038995            INGHAM
## 34 -0.128137603             IONIA
## 35  0.027636661             IOSCO
## 36  0.130371319              IRON
## 37 -0.101475239          ISABELLA
## 38  0.105659303           JACKSON
## 39  0.100879266         KALAMAZOO
## 40 -0.075924113          KALKASKA
## 41  0.104813894              KENT
## 42 -0.169611558          KEWEENAW
## 43  0.046514135              LAKE
## 44 -0.216084187            LAPEER
## 45 -0.075546269          LEELANAU
## 46  0.044995306           LENAWEE
## 47  0.076575847        LIVINGSTON
## 48 -0.001805789              LUCE
## 49 -0.093317083 MACKINAC/MICHILIM
## 50  0.061968971            MACOMB
## 51  0.039619066          MANISTEE
## 52  0.126050759         MARQUETTE
## 53  0.116743765             MASON
## 54  0.040682349           MECOSTA
## 55  0.025128222         MENOMINEE
## 56 -0.004886346           MIDLAND
## 57 -0.183214337         MISSAUKEE
## 58 -0.032406605            MONROE
## 59  0.024902446          MONTCALM
## 60  0.022383630       MONTMORENCY
## 61  0.114975307          MUSKEGON
## 62 -0.020210397           NEWAYGO
## 63  0.051362076           OAKLAND
## 64  0.027366523            OCEANA
## 65 -0.069876049            OGEMAW
## 66 -0.080123158         ONTONAGON
## 67  0.048305016           OSCEOLA
## 68 -0.010300206            OSCODA
## 69 -0.067060519            OTSEGO
## 70  0.025111206            OTTAWA
## 71 -0.192049448      PRESQUE ISLE
## 72  0.032899974         ROSCOMMON
## 73 -0.040745153           SAGINAW
## 74 -0.013826630          ST CLAIR
## 75  0.117125263         ST JOSEPH
## 76 -0.103298228           SANILAC
## 77  0.014549838       SCHOOLCRAFT
## 78 -0.043640768        SHIAWASSEE
## 79 -0.134888560           TUSCOLA
## 80  0.119313235         VAN BUREN
## 81  0.054252119         WASHTENAW
## 82  0.045686965             WAYNE
## 83  0.047936516           WEXFORD
</code></pre></div></div>

<p>#SCATTER DIAGRAM AND REGRESSION FOR MICHIGAN VAM VS EDU</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mich_vam</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">vam</span><span class="p">,</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Michigan"</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">year</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1947</span><span class="p">)</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">mich_tract</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">mich_vam</span><span class="o">$</span><span class="n">VAM</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_smooth</span><span class="p">(</span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"lm"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Michigan VAM 1947 vs % Tractor 1940"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## `geom_smooth()` using formula 'y ~ x'
</code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-5-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">outlierMich</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">michPlotSrc</span><span class="p">[</span><span class="m">44</span><span class="p">,]</span><span class="w">
</span><span class="n">outlierMich</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>##    county      avg year state   name percent_farm_tractor stateAbb  fips
## 44    870 7.881265 1930    26 LAPEER            0.1761294       MI 26087
##    colorID   logAvg   modResid   fitted
## 44       3 2.064488 -0.2194003 2.283889
</code></pre></div></div>

<h2 id="mi-edu-vs--sse">MI EDU VS % SSE</h2>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#Calculate SSE</span><span class="w">
</span><span class="n">pred_michEdu</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">michEduMod</span><span class="p">,</span><span class="w"> </span><span class="n">michPlotSrc</span><span class="p">)</span><span class="w">
</span><span class="c1">#Undo log transformation</span><span class="w">
</span><span class="n">pred_michEdu</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">pred_michEdu</span><span class="p">)</span><span class="m">-1</span><span class="w">

</span><span class="n">mean</span><span class="p">((</span><span class="n">michPlotSrc</span><span class="o">$</span><span class="n">avg</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pred_michEdu</span><span class="p">)</span><span class="o">^</span><span class="m">2</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] 1.276815
</code></pre></div></div>

<h2 id="vam-1958-vs--1950-1">VAM 1958 vs % 1950</h2>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mich1930</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">df30</span><span class="p">,</span><span class="n">stateAbb</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"MI"</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="n">mich1950</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">df50</span><span class="p">,</span><span class="n">stateAbb</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"MI"</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="n">vam_mich1957</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">vam</span><span class="p">,</span><span class="w"> </span><span class="n">year</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1958</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Michigan"</span><span class="p">)</span><span class="w">
</span><span class="n">michVam_mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">vam_mich1957</span><span class="o">$</span><span class="n">VAM</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">mich1950</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">michVam_mod</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## 
## Call:
## lm(formula = vam_mich1957$VAM ~ mich1950$percent_farm_tractor)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -365.46 -196.66  -25.15  184.44  503.44 
## 
## Coefficients:
##                               Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)                      243.3      202.0   1.204    0.233
## mich1950$percent_farm_tractor    140.9      297.2   0.474    0.637
## 
## Residual standard error: 241.4 on 62 degrees of freedom
##   (19 observations deleted due to missingness)
## Multiple R-squared:  0.003611,	Adjusted R-squared:  -0.01246 
## F-statistic: 0.2247 on 1 and 62 DF,  p-value: 0.6372
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">mich1950</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">vam_mich1957</span><span class="o">$</span><span class="n">VAM</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Michigan - 1957 VAM vs 1950 %"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-7-1.png" alt="" /><!-- --></p>

<h2 id="vam-1947-vs--1930-1">VAM 1947 vs % 1930</h2>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">vam_mich1947</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">vam</span><span class="p">,</span><span class="w"> </span><span class="n">year</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1947</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Michigan"</span><span class="p">)</span><span class="w">
</span><span class="n">michVam_mod1947</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">vam_mich1947</span><span class="o">$</span><span class="n">VAM</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">mich1930</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">michVam_mod1947</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## 
## Call:
## lm(formula = vam_mich1947$VAM ~ mich1930$percent_farm_tractor)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -427.69 -191.52   -8.99  126.28  552.66 
## 
## Coefficients:
##                               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                      71.76      62.43    1.15    0.254    
## mich1930$percent_farm_tractor  1542.55     349.03    4.42 3.24e-05 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 243.3 on 76 degrees of freedom
##   (5 observations deleted due to missingness)
## Multiple R-squared:  0.2045,	Adjusted R-squared:  0.194 
## F-statistic: 19.53 on 1 and 76 DF,  p-value: 3.24e-05
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">mich1930</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">vam_mich1947</span><span class="o">$</span><span class="n">VAM</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Michigan - 1947 VAM vs 1930 %"</span><span class="p">)</span><span class="w">  </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-8-1.png" alt="" /><!-- --></p>

<hr />

<h1 id="wisconsin">WISCONSIN<a id="wisconsin-tractor-vam-plots"></a></h1>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#Wisconsin Edu</span><span class="w">
</span><span class="n">wis_edu</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">eduDataFunc</span><span class="p">(</span><span class="s2">"Wisconsin"</span><span class="p">)</span><span class="w">

</span><span class="c1">#Wisconsin Tractor</span><span class="w">
</span><span class="n">wis_tract</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">tractDataFunc</span><span class="p">(</span><span class="s2">"WI"</span><span class="p">)</span><span class="w">

</span><span class="n">plot</span><span class="p">(</span><span class="n">wis_tract</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">wis_edu</span><span class="o">$</span><span class="n">avg</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"1930 % Tractor"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"1940 Avg. Edu"</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Wisconsin"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-9-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plot</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="n">wis_tract</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">),</span><span class="w"> </span><span class="n">wis_edu</span><span class="o">$</span><span class="n">avg</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-9-2.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">wisPlotSrc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">merge</span><span class="p">(</span><span class="n">wis_edu</span><span class="p">,</span><span class="w"> </span><span class="n">wis_tract</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"county"</span><span class="p">)</span><span class="w">

</span><span class="c1">#LOESS REGRESSION on EDU vs % Tractor</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">wisPlotSrc</span><span class="p">,</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">()</span><span class="w">  </span><span class="o">+</span><span class="w"> </span><span class="n">geom_smooth</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xlab</span><span class="p">(</span><span class="s2">"1930's % Tractor"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ylab</span><span class="p">(</span><span class="s2">"1940 Avg. Edu"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Wisconsin"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## `geom_smooth()` using method = 'loess' and formula 'y ~ x'
</code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-9-3.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#Transform response on Log Scale</span><span class="w">
</span><span class="n">wisPlotSrc</span><span class="o">$</span><span class="n">logAvg</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">log</span><span class="p">(</span><span class="n">wisPlotSrc</span><span class="o">$</span><span class="n">avg</span><span class="p">)</span><span class="w">
</span><span class="n">wisPlotSrc</span><span class="o">$</span><span class="n">logX</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">log</span><span class="p">(</span><span class="n">wisPlotSrc</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">)</span><span class="w">

</span><span class="n">plot</span><span class="p">(</span><span class="n">wisPlotSrc</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">wisPlotSrc</span><span class="o">$</span><span class="n">logAvg</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Log-Linear"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-9-4.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">wisEduMod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">logAvg</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wisPlotSrc</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">wisEduMod</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## 
## Call:
## lm(formula = logAvg ~ percent_farm_tractor, data = wisPlotSrc)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.083969 -0.025500 -0.000201  0.020619  0.092817 
## 
## Coefficients:
##                      Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)          2.265011   0.009967 227.256  &lt; 2e-16 ***
## percent_farm_tractor 0.100321   0.035121   2.856  0.00566 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.03962 on 69 degrees of freedom
## Multiple R-squared:  0.1057,	Adjusted R-squared:  0.09279 
## F-statistic: 8.159 on 1 and 69 DF,  p-value: 0.005656
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#Residuals</span><span class="w">
</span><span class="n">wisPlotSrc</span><span class="o">$</span><span class="n">modResid</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">resid</span><span class="p">(</span><span class="n">wisEduMod</span><span class="p">)</span><span class="w">
</span><span class="n">wisPlotSrc</span><span class="o">$</span><span class="n">fitted</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">wisEduMod</span><span class="p">)</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">wisPlotSrc</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fitted</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">modResid</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_hline</span><span class="p">(</span><span class="n">yintercept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"red"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"WI Edu vs Tractor Residuals"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-9-5.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#SCATTER DIAGRAM AND REGRESSION FOR WISCONSIN VAM VS EDU</span><span class="w">
</span><span class="n">wis_vam</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">vam</span><span class="p">,</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Wisconsin"</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">year</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1947</span><span class="p">)</span><span class="w">
</span><span class="n">wis_vam</span><span class="p">[</span><span class="nf">is.na</span><span class="p">(</span><span class="n">wis_vam</span><span class="p">)]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">wis_tract</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">wis_vam</span><span class="o">$</span><span class="n">VAM</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"% 1940"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"VAM 1947"</span><span class="p">,</span><span class="w"> </span><span class="n">ylim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1000</span><span class="p">),</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Wisconsin VAM vs % Tractor"</span><span class="p">)</span><span class="w">
</span><span class="n">abline</span><span class="p">(</span><span class="n">lm</span><span class="p">(</span><span class="n">wis_vam</span><span class="o">$</span><span class="n">VAM</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">wis_tract</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-9-6.png" alt="" /><!-- --></p>

<h2 id="wi-edu-vs--sse">WI EDU VS % SSE</h2>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#Calculate SSE</span><span class="w">
</span><span class="n">pred_wisEdu</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">wisEduMod</span><span class="p">,</span><span class="w"> </span><span class="n">wisPlotSrc</span><span class="p">)</span><span class="w">
</span><span class="c1">#Undo log transformation</span><span class="w">
</span><span class="n">pred_wisEdu</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">pred_wisEdu</span><span class="p">)</span><span class="m">-1</span><span class="w">

</span><span class="n">mean</span><span class="p">((</span><span class="n">wisPlotSrc</span><span class="o">$</span><span class="n">avg</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pred_wisEdu</span><span class="p">)</span><span class="o">^</span><span class="m">2</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] 1.164601
</code></pre></div></div>

<h2 id="vam-1958-vs--1950-2">VAM 1958 vs % 1950</h2>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">wis1950</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">df50</span><span class="p">,</span><span class="n">stateAbb</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"WI"</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="n">wis1930</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">df30</span><span class="p">,</span><span class="n">stateAbb</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"WI"</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="n">vam_wis1957</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">vam</span><span class="p">,</span><span class="w"> </span><span class="n">year</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1958</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Wisconsin"</span><span class="p">)</span><span class="w">
</span><span class="n">wisVam_mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">vam_wis1957</span><span class="o">$</span><span class="n">VAM</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">wis1950</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">wisVam_mod</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## 
## Call:
## lm(formula = vam_wis1957$VAM ~ wis1950$percent_farm_tractor)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -333.26 -192.11  -27.48  103.04  676.52 
## 
## Coefficients:
##                              Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)                    -2.341    237.072  -0.010    0.992
## wis1950$percent_farm_tractor  497.488    326.784   1.522    0.134
## 
## Residual standard error: 251.5 on 54 degrees of freedom
##   (15 observations deleted due to missingness)
## Multiple R-squared:  0.04115,	Adjusted R-squared:  0.0234 
## F-statistic: 2.318 on 1 and 54 DF,  p-value: 0.1337
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plot</span><span class="p">(</span><span class="n">wis1950</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">vam_wis1957</span><span class="o">$</span><span class="n">VAM</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Wisconsin - 1957 VAM vs 1950 %"</span><span class="p">)</span><span class="w">
</span><span class="n">abline</span><span class="p">(</span><span class="n">wisVam_mod</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"red"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-11-1.png" alt="" /><!-- --></p>

<h2 id="vam-1947-vs--1930-2">VAM 1947 vs % 1930</h2>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">vam_wis1947</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">vam</span><span class="p">,</span><span class="w"> </span><span class="n">year</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1947</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Wisconsin"</span><span class="p">)</span><span class="w">
</span><span class="n">wisVam_mod1947</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">vam_wis1947</span><span class="o">$</span><span class="n">VAM</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">wis1930</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">wisVam_mod1947</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## 
## Call:
## lm(formula = vam_wis1947$VAM ~ wis1930$percent_farm_tractor)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -484.24 -152.21  -90.96  135.29  674.42 
## 
## Coefficients:
##                              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                     55.46      62.58   0.886    0.379    
## wis1930$percent_farm_tractor  1046.06     228.27   4.583  2.1e-05 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 243.9 on 66 degrees of freedom
##   (3 observations deleted due to missingness)
## Multiple R-squared:  0.2414,	Adjusted R-squared:  0.2299 
## F-statistic:    21 on 1 and 66 DF,  p-value: 2.098e-05
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plot</span><span class="p">(</span><span class="n">wis1930</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">vam_wis1947</span><span class="o">$</span><span class="n">VAM</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Wisconsin - 1947 VAM vs 1930 %"</span><span class="p">)</span><span class="w">
</span><span class="n">abline</span><span class="p">(</span><span class="n">wisVam_mod1947</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"red"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-12-1.png" alt="" /><!-- --></p>

<hr />

<h1 id="indiana">INDIANA<a id="indiana-tractor-vam-plots"></a></h1>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#Indiana Edu</span><span class="w">
</span><span class="n">in_edu</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">eduDataFunc</span><span class="p">(</span><span class="s2">"Indiana"</span><span class="p">)</span><span class="w">

</span><span class="c1">#Indiana Tractor</span><span class="w">
</span><span class="n">in_tract</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">tractDataFunc</span><span class="p">(</span><span class="s2">"IN"</span><span class="p">)</span><span class="w">

</span><span class="n">plot</span><span class="p">(</span><span class="n">in_tract</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">in_edu</span><span class="o">$</span><span class="n">avg</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"1930 % Tractor"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"1940 Avg. Edu"</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Indiana"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-13-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">inPlotSrc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">merge</span><span class="p">(</span><span class="n">in_edu</span><span class="p">,</span><span class="w"> </span><span class="n">in_tract</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"county"</span><span class="p">)</span><span class="w">

</span><span class="c1">#LOESS REGRESSION on EDU vs % Tractor</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">inPlotSrc</span><span class="p">,</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">()</span><span class="w">  </span><span class="o">+</span><span class="w"> </span><span class="n">geom_smooth</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xlab</span><span class="p">(</span><span class="s2">"1930's % Tractor"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ylab</span><span class="p">(</span><span class="s2">"1940 Avg. Edu"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Indiana"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## `geom_smooth()` using method = 'loess' and formula 'y ~ x'
</code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-13-2.png" alt="" /><!-- --></p>

<p>#Transform response on Log Scale</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">inPlotSrc</span><span class="o">$</span><span class="n">logAvg</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">log</span><span class="p">(</span><span class="n">inPlotSrc</span><span class="o">$</span><span class="n">avg</span><span class="p">)</span><span class="w">

</span><span class="n">plot</span><span class="p">(</span><span class="n">inPlotSrc</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">inPlotSrc</span><span class="o">$</span><span class="n">logAvg</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Log-Linear"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-14-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">inEduMod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">logAvg</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inPlotSrc</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">inEduMod</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## 
## Call:
## lm(formula = logAvg ~ percent_farm_tractor, data = inPlotSrc)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.128838 -0.020547  0.000339  0.027807  0.068493 
## 
## Coefficients:
##                      Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)          2.271406   0.009384 242.049  &lt; 2e-16 ***
## percent_farm_tractor 0.243673   0.038546   6.322 9.74e-09 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.03588 on 90 degrees of freedom
## Multiple R-squared:  0.3075,	Adjusted R-squared:  0.2998 
## F-statistic: 39.96 on 1 and 90 DF,  p-value: 9.74e-09
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#Residuals</span><span class="w">
</span><span class="n">inPlotSrc</span><span class="o">$</span><span class="n">modResid</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">resid</span><span class="p">(</span><span class="n">inEduMod</span><span class="p">)</span><span class="w">
</span><span class="n">inPlotSrc</span><span class="o">$</span><span class="n">fitted</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">inEduMod</span><span class="p">)</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">inPlotSrc</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fitted</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">modResid</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_hline</span><span class="p">(</span><span class="n">yintercept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"red"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"IN Edu vs Tractor Residuals"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-14-2.png" alt="" /><!-- --></p>

<p>#SCATTER DIAGRAM AND REGRESSION FOR Indiana VAM VS EDU</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">in_vam</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">vam</span><span class="p">,</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Indiana"</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">year</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1947</span><span class="p">)</span><span class="w">
</span><span class="n">rownames</span><span class="p">(</span><span class="n">in_vam</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">nrow</span><span class="p">(</span><span class="n">in_vam</span><span class="p">)</span><span class="w">
</span><span class="n">in_vam</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">in_vam</span><span class="p">[</span><span class="m">-75</span><span class="p">,]</span><span class="w">
</span><span class="n">rownames</span><span class="p">(</span><span class="n">in_vam</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">nrow</span><span class="p">(</span><span class="n">in_vam</span><span class="p">)</span><span class="w">
</span><span class="n">in_vam</span><span class="p">[</span><span class="nf">is.na</span><span class="p">(</span><span class="n">in_vam</span><span class="p">)]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">in_tract</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">in_vam</span><span class="o">$</span><span class="n">VAM</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"% 1940"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"VAM 1947"</span><span class="p">,</span><span class="w"> </span><span class="n">ylim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1000</span><span class="p">),</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Indiana VAM vs % Tractor"</span><span class="p">)</span><span class="w">
</span><span class="n">abline</span><span class="p">(</span><span class="n">lm</span><span class="p">(</span><span class="n">in_vam</span><span class="o">$</span><span class="n">VAM</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">in_tract</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-15-1.png" alt="" /><!-- --></p>

<p>#Indiana - Median</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">inMedian</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">eduMedianFunc</span><span class="p">(</span><span class="s2">"Indiana"</span><span class="p">)</span><span class="w">

</span><span class="n">plot</span><span class="p">(</span><span class="n">jitter</span><span class="p">(</span><span class="n">in_tract</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">),</span><span class="w"> </span><span class="n">jitter</span><span class="p">(</span><span class="n">inMedian</span><span class="o">$</span><span class="n">med</span><span class="p">),</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"% 1930"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="s2">"Median years education"</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Indiana- Median"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-16-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">inMedian</span><span class="o">$</span><span class="n">logMed</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">log</span><span class="p">(</span><span class="n">inMedian</span><span class="o">$</span><span class="n">med</span><span class="p">)</span><span class="w">

</span><span class="n">plot</span><span class="p">(</span><span class="n">jitter</span><span class="p">(</span><span class="n">in_tract</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">),</span><span class="w"> </span><span class="n">jitter</span><span class="p">(</span><span class="n">inMedian</span><span class="o">$</span><span class="n">logMed</span><span class="p">),</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"% 1930"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="s2">"Median years education"</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Indiana- LogMedian"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-16-2.png" alt="" /><!-- --></p>

<h3 id="indiana---median-model">Indiana - Median Model</h3>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plotSrc_med_in</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">merge</span><span class="p">(</span><span class="n">inMedian</span><span class="p">,</span><span class="w"> </span><span class="n">in_tract</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"county"</span><span class="p">)</span><span class="w">
</span><span class="n">inEduMod_med</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">logMed</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">plotSrc_med_in</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">inEduMod_med</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## 
## Call:
## lm(formula = logMed ~ percent_farm_tractor, data = plotSrc_med_in)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.217651 -0.021463 -0.000837  0.035208  0.135319 
## 
## Coefficients:
##                      Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           2.27671    0.01582   143.9  &lt; 2e-16 ***
## percent_farm_tractor  0.38349    0.06500     5.9  6.3e-08 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.0605 on 90 degrees of freedom
## Multiple R-squared:  0.2789,	Adjusted R-squared:  0.2709 
## F-statistic: 34.81 on 1 and 90 DF,  p-value: 6.296e-08
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">in_med_df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as.data.frame</span><span class="p">(</span><span class="n">resid</span><span class="p">(</span><span class="n">inEduMod_med</span><span class="p">))</span><span class="w">
</span><span class="n">in_med_df</span><span class="o">$</span><span class="n">county</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">plotSrc_med_in</span><span class="o">$</span><span class="n">name</span><span class="w">
</span><span class="n">colnames</span><span class="p">(</span><span class="n">in_med_df</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="w"> </span><span class="s2">"residual"</span><span class="p">,</span><span class="w"> </span><span class="s2">"county"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<h3 id="indiana-median-model-county-residuals">Indiana Median Model County Residuals</h3>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">in_med_df</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>##         residual      county
## 1  -0.0039011654       ADAMS
## 2  -0.0045533470       ALLEN
## 3   0.0485600175 BARTHOLOMEW
## 4  -0.0556421083      BENTON
## 5   0.0397637243   BLACKFORD
## 6   0.0172311300       BOONE
## 7  -0.0974781526       BROWN
## 8  -0.0349227644     CARROLL
## 9   0.0353692131        CASS
## 10 -0.0304488200       CLARK
## 11  0.0702713112        CLAY
## 12 -0.0050793908     CLINTON
## 13 -0.2176513073    CRAWFORD
## 14 -0.0297271964     DAVIESS
## 15 -0.0268200706    DEARBORN
## 16 -0.0124768965     DECATUR
## 17  0.0184916342     DE KALB
## 18  0.0351542336    DELAWARE
## 19 -0.1312904249      DUBOIS
## 20  0.0608813534     ELKHART
## 21 -0.1196820773     FAYETTE
## 22 -0.0241780504       FLOYD
## 23  0.0115811945    FOUNTAIN
## 24 -0.1688033073    FRANKLIN
## 25  0.0746289970      FULTON
## 26  0.0253089310      GIBSON
## 27 -0.0007629611       GRANT
## 28  0.0866655157      GREENE
## 29 -0.0014830516    HAMILTON
## 30  0.0116994290     HANCOCK
## 31 -0.0128748566    HARRISON
## 32  0.0177421484   HENDRICKS
## 33  0.0178206224       HENRY
## 34 -0.0025762048      HOWARD
## 35  0.1042119985  HUNTINGTON
## 36 -0.0313739026     JACKSON
## 37  0.0069599110      JASPER
## 38  0.0473013013         JAY
## 39 -0.0122367435   JEFFERSON
## 40 -0.0157585697    JENNINGS
## 41 -0.0086250188     JOHNSON
## 42  0.0122629645        KNOX
## 43  0.0662756138   KOSCIUSKO
## 44 -0.0317447280    LAGRANGE
## 45 -0.0050625322        LAKE
## 46  0.0047870347    LA PORTE
## 47 -0.0144954635    LAWRENCE
## 48  0.0113978554     MADISON
## 49  0.0066256475      MARION
## 50  0.0609437234    MARSHALL
## 51 -0.0171457002      MARTIN
## 52  0.0190393905       MIAMI
## 53 -0.0009467869      MONROE
## 54  0.0065750034  MONTGOMERY
## 55  0.0373660608      MORGAN
## 56 -0.0211253141      NEWTON
## 57  0.0415637340       NOBLE
## 58  0.0745590830        OHIO
## 59 -0.0223773748      ORANGE
## 60  0.0909766279        OWEN
## 61  0.0448138997       PARKE
## 62 -0.1093545276       PERRY
## 63 -0.0145292159        PIKE
## 64  0.0201064860      PORTER
## 65 -0.1790683618       POSEY
## 66 -0.0667393709     PULASKI
## 67  0.0619769431      PUTNAM
## 68  0.0232313852    RANDOLPH
## 69 -0.0342631411      RIPLEY
## 70 -0.0356922635        RUSH
## 71  0.0262023096   ST JOSEPH
## 72 -0.0171502153       SCOTT
## 73  0.0008867328      SHELBY
## 74 -0.0079500668     SPENCER
## 75 -0.0655714442      STARKE
## 76  0.1309497809     STEUBEN
## 77  0.0687769074    SULLIVAN
## 78 -0.1054192161 SWITZERLAND
## 79 -0.0023580977  TIPPECANOE
## 80  0.0011144066      TIPTON
## 81 -0.0256990445       UNION
## 82  0.0413615048 VANDERBURGH
## 83  0.0276761811  VERMILLION
## 84  0.0607328271        VIGO
## 85  0.0055664474      WABASH
## 86 -0.0211584038      WARREN
## 87 -0.0186099550     WARRICK
## 88 -0.0263503943  WASHINGTON
## 89 -0.0009102887       WAYNE
## 90  0.0916333530       WELLS
## 91 -0.0102948964       WHITE
## 92  0.1353186218     WHITLEY
</code></pre></div></div>
<h2 id="in-edu-vs--sse">IN EDU VS % SSE</h2>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#Calculate SSE</span><span class="w">
</span><span class="n">pred_inEdu</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">inEduMod</span><span class="p">,</span><span class="w"> </span><span class="n">inPlotSrc</span><span class="p">)</span><span class="w">
</span><span class="c1">#Undo log transformation</span><span class="w">
</span><span class="n">pred_inEdu</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">pred_inEdu</span><span class="p">)</span><span class="m">-1</span><span class="w">

</span><span class="n">mean</span><span class="p">((</span><span class="n">inPlotSrc</span><span class="o">$</span><span class="n">avg</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pred_inEdu</span><span class="p">)</span><span class="o">^</span><span class="m">2</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] 1.13942
</code></pre></div></div>

<h2 id="vam-1958-vs--1950-3">VAM 1958 vs % 1950</h2>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">in1950</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">df50</span><span class="p">,</span><span class="n">stateAbb</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"IN"</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="n">in1930</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">df30</span><span class="p">,</span><span class="n">stateAbb</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"IN"</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="n">vam_in1957</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">vam</span><span class="p">,</span><span class="w"> </span><span class="n">year</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1958</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Indiana"</span><span class="p">)</span><span class="w">
</span><span class="n">inVam_mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">vam_in1957</span><span class="o">$</span><span class="n">VAM</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">in1950</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">inVam_mod</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## 
## Call:
## lm(formula = vam_in1957$VAM ~ in1950$percent_farm_tractor)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -450.65 -242.12  -46.76  201.85  583.08 
## 
## Coefficients:
##                             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)                    142.0      173.0   0.821    0.415
## in1950$percent_farm_tractor    395.2      269.2   1.468    0.147
## 
## Residual standard error: 289 on 69 degrees of freedom
##   (21 observations deleted due to missingness)
## Multiple R-squared:  0.03028,	Adjusted R-squared:  0.01623 
## F-statistic: 2.155 on 1 and 69 DF,  p-value: 0.1467
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plot</span><span class="p">(</span><span class="n">in1950</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">vam_in1957</span><span class="o">$</span><span class="n">VAM</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Indiana - 1957 VAM vs 1950 %"</span><span class="p">)</span><span class="w">
</span><span class="n">abline</span><span class="p">(</span><span class="n">inVam_mod</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"red"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-20-1.png" alt="" /><!-- --></p>

<h2 id="vam-1947-vs--1930-3">VAM 1947 vs % 1930</h2>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">vam_in1947</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">vam</span><span class="p">,</span><span class="w"> </span><span class="n">year</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1947</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Indiana"</span><span class="p">)</span><span class="w">
</span><span class="n">vam_in1947</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">vam_in1947</span><span class="p">[</span><span class="m">-75</span><span class="p">,]</span><span class="w">

</span><span class="n">inVam_mod1947</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">vam_in1947</span><span class="o">$</span><span class="n">VAM</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">in1930</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">inVam_mod1947</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## 
## Call:
## lm(formula = vam_in1947$VAM ~ in1930$percent_farm_tractor)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -325.84 -212.46  -97.32  134.94  702.92 
## 
## Coefficients:
##                             Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)                   244.49      72.15   3.389  0.00108 **
## in1930$percent_farm_tractor   232.64     303.97   0.765  0.44627   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 269.6 on 82 degrees of freedom
##   (8 observations deleted due to missingness)
## Multiple R-squared:  0.007092,	Adjusted R-squared:  -0.005016 
## F-statistic: 0.5857 on 1 and 82 DF,  p-value: 0.4463
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plot</span><span class="p">(</span><span class="n">in1930</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">vam_in1947</span><span class="o">$</span><span class="n">VAM</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Indiana - 1947 VAM vs 1930 %"</span><span class="p">)</span><span class="w">
</span><span class="n">abline</span><span class="p">(</span><span class="n">inVam_mod1947</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"red"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<h2><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-21-1.png" alt="" /><!-- --></h2>

<h1 id="illinois">Illinois<a id="illinois-tractor-vam-plots"></a></h1>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#Illinois Edu</span><span class="w">
</span><span class="n">il_edu</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">eduDataFunc</span><span class="p">(</span><span class="s2">"Illinois"</span><span class="p">)</span><span class="w">

</span><span class="n">il_edu_med</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">eduMedianFunc</span><span class="p">(</span><span class="s2">"Illinois"</span><span class="p">)</span><span class="w">

</span><span class="c1">#Illinois Tractor</span><span class="w">
</span><span class="n">il_tract</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">tractDataFunc</span><span class="p">(</span><span class="s2">"IL"</span><span class="p">)</span><span class="w">

</span><span class="n">plot</span><span class="p">(</span><span class="n">il_tract</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">il_edu</span><span class="o">$</span><span class="n">avg</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"1930 % Tractor"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"1940 Avg. Edu"</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Illinois"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-22-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plot</span><span class="p">(</span><span class="n">il_tract</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">il_edu_med</span><span class="o">$</span><span class="n">med</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"1930 % Tractor"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"1940 Med. Edu"</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Illinois"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-22-2.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ilPlotSrc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">merge</span><span class="p">(</span><span class="n">il_edu</span><span class="p">,</span><span class="w"> </span><span class="n">il_tract</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"county"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>
<p>#LOESS REGRESSION on EDU vs % Tractor</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ggplot</span><span class="p">(</span><span class="n">ilPlotSrc</span><span class="p">,</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">()</span><span class="w">  </span><span class="o">+</span><span class="w"> </span><span class="n">geom_smooth</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xlab</span><span class="p">(</span><span class="s2">"1930's % Tractor"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ylab</span><span class="p">(</span><span class="s2">"1940 Avg. Edu"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Illinois"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## `geom_smooth()` using method = 'loess' and formula 'y ~ x'
</code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-23-1.png" alt="" /><!-- --></p>

<p>#Transform response on Log Scale</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ilPlotSrc</span><span class="o">$</span><span class="n">logAvg</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">log</span><span class="p">(</span><span class="n">ilPlotSrc</span><span class="o">$</span><span class="n">avg</span><span class="p">)</span><span class="w">

</span><span class="n">plot</span><span class="p">(</span><span class="n">ilPlotSrc</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">ilPlotSrc</span><span class="o">$</span><span class="n">logAvg</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Log-Linear"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-24-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ilEduMod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">logAvg</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ilPlotSrc</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">ilEduMod</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## 
## Call:
## lm(formula = logAvg ~ percent_farm_tractor, data = ilPlotSrc)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.228625 -0.017533  0.009969  0.029582  0.071982 
## 
## Coefficients:
##                      Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           2.22397    0.01067 208.505  &lt; 2e-16 ***
## percent_farm_tractor  0.22051    0.03129   7.047 2.39e-10 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.04953 on 100 degrees of freedom
## Multiple R-squared:  0.3318,	Adjusted R-squared:  0.3251 
## F-statistic: 49.66 on 1 and 100 DF,  p-value: 2.385e-10
</code></pre></div></div>

<p>#Residuals - Mean Model</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ilPlotSrc</span><span class="o">$</span><span class="n">modResid</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">resid</span><span class="p">(</span><span class="n">ilEduMod</span><span class="p">)</span><span class="w">
</span><span class="n">ilPlotSrc</span><span class="o">$</span><span class="n">fitted</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">ilEduMod</span><span class="p">)</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">ilPlotSrc</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fitted</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">modResid</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_hline</span><span class="p">(</span><span class="n">yintercept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"red"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"IL Edu vs Tractor Residuals"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-25-1.png" alt="" /><!-- --></p>

<p>#SCATTER DIAGRAM AND REGRESSION FOR Illinois VAM VS EDU</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">il_vam</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">vam</span><span class="p">,</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Illinois"</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">year</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1947</span><span class="p">)</span><span class="w">
</span><span class="n">rownames</span><span class="p">(</span><span class="n">il_vam</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">nrow</span><span class="p">(</span><span class="n">il_vam</span><span class="p">)</span><span class="w">
</span><span class="n">il_vam</span><span class="p">[</span><span class="nf">is.na</span><span class="p">(</span><span class="n">il_vam</span><span class="p">)]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">il_tract</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">il_vam</span><span class="o">$</span><span class="n">VAM</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"% 1940"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"VAM 1947"</span><span class="p">,</span><span class="w"> </span><span class="n">ylim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1000</span><span class="p">),</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Illinois VAM vs % Tractor"</span><span class="p">)</span><span class="w">
</span><span class="n">abline</span><span class="p">(</span><span class="n">lm</span><span class="p">(</span><span class="n">il_vam</span><span class="o">$</span><span class="n">VAM</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">il_tract</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-26-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#Identify outliers</span><span class="w">
 </span><span class="c1">#outlier &lt;- ilPlotSrc[c(35,54),]</span><span class="w">
 </span><span class="c1">#outlier</span><span class="w">
</span></code></pre></div></div>

<p>#Illinois - Median</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ilMedian</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">eduMedianFunc</span><span class="p">(</span><span class="s2">"Illinois"</span><span class="p">)</span><span class="w">

</span><span class="n">plot</span><span class="p">(</span><span class="n">jitter</span><span class="p">(</span><span class="n">il_tract</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">),</span><span class="w"> </span><span class="n">jitter</span><span class="p">(</span><span class="n">ilMedian</span><span class="o">$</span><span class="n">med</span><span class="p">),</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"% 1930"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="s2">"Median years education"</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Illinois- Median"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-27-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ilMedian</span><span class="o">$</span><span class="n">logMed</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">log</span><span class="p">(</span><span class="n">ilMedian</span><span class="o">$</span><span class="n">med</span><span class="p">)</span><span class="w">

</span><span class="n">plot</span><span class="p">(</span><span class="n">jitter</span><span class="p">(</span><span class="n">il_tract</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">),</span><span class="w"> </span><span class="n">jitter</span><span class="p">(</span><span class="n">ilMedian</span><span class="o">$</span><span class="n">logMed</span><span class="p">),</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"% 1930"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="s2">"Median years education"</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Illinois - LogMedian"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-27-2.png" alt="" /><!-- --></p>

<h3 id="illinois---median-model">Illinois - Median Model</h3>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plotSrc_med_il</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">merge</span><span class="p">(</span><span class="n">ilMedian</span><span class="p">,</span><span class="w"> </span><span class="n">il_tract</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"county"</span><span class="p">)</span><span class="w">
</span><span class="n">ilEduMod_med</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">logMed</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">plotSrc_med_il</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">ilEduMod_med</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## 
## Call:
## lm(formula = logMed ~ percent_farm_tractor, data = plotSrc_med_il)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.249730 -0.045203  0.009157  0.059213  0.177344 
## 
## Coefficients:
##                      Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           2.18273    0.01665 131.079  &lt; 2e-16 ***
## percent_farm_tractor  0.40905    0.04885   8.373 3.56e-13 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.07732 on 100 degrees of freedom
## Multiple R-squared:  0.4121,	Adjusted R-squared:  0.4063 
## F-statistic: 70.11 on 1 and 100 DF,  p-value: 3.56e-13
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">il_med_df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as.data.frame</span><span class="p">(</span><span class="n">resid</span><span class="p">(</span><span class="n">ilEduMod_med</span><span class="p">))</span><span class="w">
</span><span class="n">il_med_df</span><span class="o">$</span><span class="n">county</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">plotSrc_med_il</span><span class="o">$</span><span class="n">name</span><span class="w">
</span><span class="n">colnames</span><span class="p">(</span><span class="n">il_med_df</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="w"> </span><span class="s2">"residual"</span><span class="p">,</span><span class="w"> </span><span class="s2">"county"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<h3 id="illinois-median-model-county-residuals">Illinois Median Model County Residuals</h3>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">il_med_df</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>##          residual      county
## 1    0.1159811021       ADAMS
## 2   -0.0219127354   ALEXANDER
## 3    0.0624933542        BOND
## 4   -0.0654303756       BOONE
## 5   -0.0574486943       BROWN
## 6    0.0242888950      BUREAU
## 7   -0.1739178024     CALHOUN
## 8    0.0087382195     CARROLL
## 9    0.0886314774        CASS
## 10   0.0685975463   CHAMPAIGN
## 11   0.0418905544   CHRISTIAN
## 12   0.0611637588       CLARK
## 13   0.0786393457        CLAY
## 14  -0.1803182776     CLINTON
## 15  -0.0684271244       COLES
## 16   0.0623256695        COOK
## 17   0.0456704740    CRAWFORD
## 18  -0.0679222565  CUMBERLAND
## 19   0.0003174398     DE KALB
## 20   0.0369388999     DE WITT
## 21  -0.0121108973     DOUGLAS
## 22   0.0011764439     DU PAGE
## 23  -0.0412973841       EDGAR
## 24   0.1528184335     EDWARDS
## 25   0.0628052418   EFFINGHAM
## 26  -0.0263809189     FAYETTE
## 27  -0.0386041590        FORD
## 28   0.0898362723    FRANKLIN
## 29   0.0884042556      FULTON
## 30  -0.1466355434    GALLATIN
## 31   0.0047574633      GREENE
## 32  -0.0950695919      GRUNDY
## 33  -0.1158571443    HAMILTON
## 34   0.1001316688     HANCOCK
## 35  -0.1132479844      HARDIN
## 36  -0.0219548279   HENDERSON
## 37   0.0420705665       HENRY
## 38  -0.0425400636    IROQUOIS
## 39   0.0372132464     JACKSON
## 40  -0.0460045118      JASPER
## 41  -0.0043966604   JEFFERSON
## 42  -0.0803185571      JERSEY
## 43   0.0003591042  JO DAVIESS
## 44  -0.0141440802     JOHNSON
## 45  -0.0135144444        KANE
## 46  -0.0472771443    KANKAKEE
## 47  -0.0259537624     KENDALL
## 48   0.0643324148        KNOX
## 49   0.0383327769        LAKE
## 50  -0.0812555084    LA SALLE
## 51   0.0350188042    LAWRENCE
## 52  -0.0578001067         LEE
## 53  -0.1113619253  LIVINGSTON
## 54  -0.0888060358       LOGAN
## 55   0.0665464003   MCDONOUGH
## 56   0.0518321475     MCHENRY
## 57   0.0181006265      MCLEAN
## 58   0.0459426482       MACON
## 59   0.0181559531    MACOUPIN
## 60   0.1161359591     MADISON
## 61   0.1773444851      MARION
## 62   0.0183762184    MARSHALL
## 63  -0.0209660543       MASON
## 64  -0.1304346238      MASSAC
## 65  -0.0118754277      MENARD
## 66   0.0700801133      MERCER
## 67  -0.2497303150      MONROE
## 68   0.0308361603  MONTGOMERY
## 69  -0.0019366361      MORGAN
## 70  -0.0427986618    MOULTRIE
## 71   0.0526453814        OGLE
## 72   0.0796242229      PEORIA
## 73  -0.0378438141       PERRY
## 74  -0.0068854448       PIATT
## 75   0.0363154089        PIKE
## 76  -0.1222652841        POPE
## 77  -0.0226174880     PULASKI
## 78  -0.0952511555      PUTNAM
## 79  -0.0634426356    RANDOLPH
## 80   0.0682259564    RICHLAND
## 81   0.0668327657 ROCK ISLAND
## 82   0.0123034269    ST CLAIR
## 83   0.0920240633      SALINE
## 84   0.0860022708    SANGAMON
## 85   0.0215368204    SCHUYLER
## 86  -0.0224760426       SCOTT
## 87   0.0249810386      SHELBY
## 88   0.0324385486       STARK
## 89   0.0598519133  STEPHENSON
## 90   0.0399708018    TAZEWELL
## 91  -0.0599806613       UNION
## 92   0.0572966517   VERMILION
## 93   0.1091509767      WABASH
## 94   0.0406126587      WARREN
## 95  -0.1551419151  WASHINGTON
## 96  -0.1299853400       WAYNE
## 97   0.0551008245       WHITE
## 98  -0.0288185389   WHITESIDE
## 99  -0.0702678619        WILL
## 100  0.0871343160  WILLIAMSON
## 101  0.0747176896   WINNEBAGO
## 102  0.0095765416    WOODFORD
</code></pre></div></div>

<h2 id="il-edu-vs--sse">IL EDU VS % SSE</h2>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#Calculate SSE</span><span class="w">
</span><span class="n">pred_ilEdu</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">ilEduMod</span><span class="p">,</span><span class="w"> </span><span class="n">ilPlotSrc</span><span class="p">)</span><span class="w">
</span><span class="c1">#Undo log transformation</span><span class="w">
</span><span class="n">pred_ilEdu</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">pred_ilEdu</span><span class="p">)</span><span class="m">-1</span><span class="w">

</span><span class="n">mean</span><span class="p">((</span><span class="n">ilPlotSrc</span><span class="o">$</span><span class="n">avg</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pred_ilEdu</span><span class="p">)</span><span class="o">^</span><span class="m">2</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] 1.239245
</code></pre></div></div>

<h2 id="vam-1958-vs--1950-4">VAM 1958 vs % 1950</h2>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">il1950</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">df50</span><span class="p">,</span><span class="n">stateAbb</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"IL"</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="n">vam_il1957</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">vam</span><span class="p">,</span><span class="w"> </span><span class="n">year</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1958</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Illinois"</span><span class="p">)</span><span class="w">
</span><span class="n">ilVam_mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">vam_il1957</span><span class="o">$</span><span class="n">VAM</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">il1950</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">ilVam_mod</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## 
## Call:
## lm(formula = vam_il1957$VAM ~ il1950$percent_farm_tractor)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -360.14 -182.35  -65.27  114.67  678.66 
## 
## Coefficients:
##                             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)                    -37.6      133.4  -0.282   0.7787  
## il1950$percent_farm_tractor    455.0      186.6   2.438   0.0169 *
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 254.5 on 82 degrees of freedom
##   (18 observations deleted due to missingness)
## Multiple R-squared:  0.06759,	Adjusted R-squared:  0.05622 
## F-statistic: 5.944 on 1 and 82 DF,  p-value: 0.01693
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plot</span><span class="p">(</span><span class="n">il1950</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">vam_il1957</span><span class="o">$</span><span class="n">VAM</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Illinois - 1957 VAM vs 1950 %"</span><span class="p">)</span><span class="w">
</span><span class="n">abline</span><span class="p">(</span><span class="n">ilVam_mod</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"red"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-31-1.png" alt="" /><!-- --></p>

<h2 id="vam-1947-vs--1930-4">VAM 1947 vs % 1930</h2>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">il1930</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">df30</span><span class="p">,</span><span class="w"> </span><span class="n">stateAbb</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"IL"</span><span class="p">)</span><span class="w">
</span><span class="n">ilVam_mod1947</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">il_vam</span><span class="o">$</span><span class="n">VAM</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">il1930</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">ilVam_mod1947</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## 
## Call:
## lm(formula = il_vam$VAM ~ il1930$percent_farm_tractor)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -360.67 -162.22  -84.38  119.71  713.75 
## 
## Coefficients:
##                             Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)                    90.09      52.08   1.730  0.08673 . 
## il1930$percent_farm_tractor   436.14     152.79   2.855  0.00524 **
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 241.8 on 100 degrees of freedom
## Multiple R-squared:  0.07535,	Adjusted R-squared:  0.0661 
## F-statistic: 8.149 on 1 and 100 DF,  p-value: 0.00524
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plot</span><span class="p">(</span><span class="n">il1930</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">il_vam</span><span class="o">$</span><span class="n">VAM</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Illinois - 1947 VAM vs 1930 %"</span><span class="p">)</span><span class="w">
</span><span class="n">abline</span><span class="p">(</span><span class="n">ilVam_mod1947</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"red"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-32-1.png" alt="" /><!-- --></p>

<hr />

<h1 id="iowa">IOWA<a id="iowa-tractor-vam-plots"></a></h1>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#Iowa Edu</span><span class="w">
</span><span class="n">ia_edu</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">eduDataFunc</span><span class="p">(</span><span class="s2">"Iowa"</span><span class="p">)</span><span class="w">

</span><span class="c1">#Iowa Tractor</span><span class="w">
</span><span class="n">ia_tract</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">tractDataFunc</span><span class="p">(</span><span class="s2">"IA"</span><span class="p">)</span><span class="w">

</span><span class="n">plot</span><span class="p">(</span><span class="n">ia_tract</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">ia_edu</span><span class="o">$</span><span class="n">avg</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"1930 % Tractor"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"1940 Avg. Edu"</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Iowa"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-33-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">iaPlotSrc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">merge</span><span class="p">(</span><span class="n">ia_edu</span><span class="p">,</span><span class="w"> </span><span class="n">ia_tract</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"county"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>#LOESS REGRESSION on EDU vs % Tractor</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ggplot</span><span class="p">(</span><span class="n">iaPlotSrc</span><span class="p">,</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">()</span><span class="w">  </span><span class="o">+</span><span class="w"> </span><span class="n">geom_smooth</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xlab</span><span class="p">(</span><span class="s2">"1930's % Tractor"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ylab</span><span class="p">(</span><span class="s2">"1940 Avg. Edu"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Iowa"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## `geom_smooth()` using method = 'loess' and formula 'y ~ x'
</code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-34-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#Transform response on Log Scale</span><span class="w">
</span><span class="n">iaPlotSrc</span><span class="o">$</span><span class="n">logAvg</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">log</span><span class="p">(</span><span class="n">iaPlotSrc</span><span class="o">$</span><span class="n">avg</span><span class="p">)</span><span class="w">

</span><span class="n">plot</span><span class="p">(</span><span class="n">iaPlotSrc</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">iaPlotSrc</span><span class="o">$</span><span class="n">logAvg</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Log-Linear"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-34-2.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">iaEduMod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">logAvg</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iaPlotSrc</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">iaEduMod</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## 
## Call:
## lm(formula = logAvg ~ percent_farm_tractor, data = iaPlotSrc)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.07421 -0.02169  0.00363  0.02606  0.07078 
## 
## Coefficients:
##                      Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           2.30712    0.01167 197.644   &lt;2e-16 ***
## percent_farm_tractor  0.09378    0.03806   2.464   0.0155 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.03359 on 97 degrees of freedom
## Multiple R-squared:  0.05892,	Adjusted R-squared:  0.04922 
## F-statistic: 6.073 on 1 and 97 DF,  p-value: 0.01548
</code></pre></div></div>

<p>#Residuals</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">iaPlotSrc</span><span class="o">$</span><span class="n">modResid</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">resid</span><span class="p">(</span><span class="n">iaEduMod</span><span class="p">)</span><span class="w">
</span><span class="n">iaPlotSrc</span><span class="o">$</span><span class="n">fitted</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">iaEduMod</span><span class="p">)</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">iaPlotSrc</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fitted</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">modResid</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_hline</span><span class="p">(</span><span class="n">yintercept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"red"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"IA Edu vs Tractor Residuals"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-35-1.png" alt="" /><!-- --></p>

<p>#SCATTER DIAGRAM AND REGRESSION FOR Indiana VAM VS EDU</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ia_vam</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">vam</span><span class="p">,</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Iowa"</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">year</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1947</span><span class="p">)</span><span class="w">
</span><span class="n">rownames</span><span class="p">(</span><span class="n">ia_vam</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">nrow</span><span class="p">(</span><span class="n">ia_vam</span><span class="p">)</span><span class="w">
</span><span class="n">ia_vam</span><span class="p">[</span><span class="nf">is.na</span><span class="p">(</span><span class="n">ia_vam</span><span class="p">)]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">ia_tract</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">ia_vam</span><span class="o">$</span><span class="n">VAM</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"% 1940"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"VAM 1947"</span><span class="p">,</span><span class="w"> </span><span class="n">ylim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1000</span><span class="p">),</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Iowa VAM vs % Tractor"</span><span class="p">)</span><span class="w">
</span><span class="n">abline</span><span class="p">(</span><span class="n">lm</span><span class="p">(</span><span class="n">ia_vam</span><span class="o">$</span><span class="n">VAM</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">ia_tract</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-36-1.png" alt="" /><!-- --></p>

<h2 id="ia-edu-vs--sum-of-squares-error">IA EDU VS % Sum of Squares Error</h2>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#Calculate SSE</span><span class="w">
</span><span class="n">pred_iaEdu</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">iaEduMod</span><span class="p">,</span><span class="w"> </span><span class="n">iaPlotSrc</span><span class="p">)</span><span class="w">
</span><span class="c1">#Undo log transformation</span><span class="w">
</span><span class="n">pred_iaEdu</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">pred_iaEdu</span><span class="p">)</span><span class="m">-1</span><span class="w">

</span><span class="n">mean</span><span class="p">((</span><span class="n">iaPlotSrc</span><span class="o">$</span><span class="n">avg</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pred_iaEdu</span><span class="p">)</span><span class="o">^</span><span class="m">2</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] 1.128052
</code></pre></div></div>

<h2 id="vam-1958-vs--1950-5">VAM 1958 vs % 1950</h2>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ia1950</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">df50</span><span class="p">,</span><span class="n">stateAbb</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"IA"</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="n">vam_ia1957</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">vam</span><span class="p">,</span><span class="w"> </span><span class="n">year</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1958</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Iowa"</span><span class="p">)</span><span class="w">
</span><span class="n">iaVam_mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">vam_ia1957</span><span class="o">$</span><span class="n">VAM</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">ia1950</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">iaVam_mod</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## 
## Call:
## lm(formula = vam_ia1957$VAM ~ ia1950$percent_farm_tractor)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -186.93 -116.61  -54.65   28.86  770.95 
## 
## Coefficients:
##                             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)                   -132.8      197.6  -0.672    0.503
## ia1950$percent_farm_tractor    384.9      249.0   1.546    0.126
## 
## Residual standard error: 190 on 86 degrees of freedom
##   (11 observations deleted due to missingness)
## Multiple R-squared:  0.02703,	Adjusted R-squared:  0.01572 
## F-statistic: 2.389 on 1 and 86 DF,  p-value: 0.1258
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plot</span><span class="p">(</span><span class="n">ia1950</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">vam_ia1957</span><span class="o">$</span><span class="n">VAM</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Iowa - 1957 VAM vs 1950 %"</span><span class="p">)</span><span class="w">
</span><span class="n">abline</span><span class="p">(</span><span class="n">iaVam_mod</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"red"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-38-1.png" alt="" /><!-- --></p>

<h2 id="vam-1947-vs--1930-5">VAM 1947 vs % 1930</h2>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ia1930</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">df30</span><span class="p">,</span><span class="w"> </span><span class="n">stateAbb</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"IA"</span><span class="p">)</span><span class="w">
</span><span class="n">iaVam_mod1947</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">ia_vam</span><span class="o">$</span><span class="n">VAM</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">ia1930</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">iaVam_mod1947</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## 
## Call:
## lm(formula = ia_vam$VAM ~ ia1930$percent_farm_tractor)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -132.30 -105.02  -80.41   -4.50  797.25 
## 
## Coefficients:
##                             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)                    97.02      66.75   1.454    0.149
## ia1930$percent_farm_tractor    98.86     217.61   0.454    0.651
## 
## Residual standard error: 192.1 on 97 degrees of freedom
## Multiple R-squared:  0.002123,	Adjusted R-squared:  -0.008164 
## F-statistic: 0.2064 on 1 and 97 DF,  p-value: 0.6506
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plot</span><span class="p">(</span><span class="n">ia1930</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">ia_vam</span><span class="o">$</span><span class="n">VAM</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Iowa - 1947 VAM vs 1930 %"</span><span class="p">)</span><span class="w">
</span><span class="n">abline</span><span class="p">(</span><span class="n">iaVam_mod1947</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"red"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-39-1.png" alt="" /><!-- --></p>

<p>#Iowa - Median</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">iaMedian</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">eduMedianFunc</span><span class="p">(</span><span class="s2">"Iowa"</span><span class="p">)</span><span class="w">

</span><span class="n">plot</span><span class="p">(</span><span class="n">jitter</span><span class="p">(</span><span class="n">ia_tract</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">),</span><span class="w"> </span><span class="n">jitter</span><span class="p">(</span><span class="n">iaMedian</span><span class="o">$</span><span class="n">med</span><span class="p">),</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"% 1930"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="s2">"Median years education"</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Iowa - Median"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-40-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">iaMedian</span><span class="o">$</span><span class="n">logMed</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">log</span><span class="p">(</span><span class="n">iaMedian</span><span class="o">$</span><span class="n">med</span><span class="p">)</span><span class="w">

</span><span class="n">plot</span><span class="p">(</span><span class="n">jitter</span><span class="p">(</span><span class="n">ia_tract</span><span class="o">$</span><span class="n">percent_farm_tractor</span><span class="p">),</span><span class="w"> </span><span class="n">jitter</span><span class="p">(</span><span class="n">iaMedian</span><span class="o">$</span><span class="n">logMed</span><span class="p">),</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"% 1930"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="s2">"Median years education"</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Iowa - LogMedian"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-40-2.png" alt="" /><!-- --></p>

<h3 id="iowa---median-model">Iowa - Median Model</h3>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plotSrc_med_ia</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">merge</span><span class="p">(</span><span class="n">iaMedian</span><span class="p">,</span><span class="w"> </span><span class="n">ia_tract</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"county"</span><span class="p">)</span><span class="w">
</span><span class="n">iaEduMod_med</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">logMed</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">percent_farm_tractor</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">plotSrc_med_ia</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">iaEduMod_med</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## 
## Call:
## lm(formula = logMed ~ percent_farm_tractor, data = plotSrc_med_ia)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.17834 -0.02710  0.01407  0.02660  0.12513 
## 
## Coefficients:
##                      Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           2.33110    0.02033 114.680   &lt;2e-16 ***
## percent_farm_tractor  0.15680    0.06627   2.366     0.02 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.05849 on 97 degrees of freedom
## Multiple R-squared:  0.05457,	Adjusted R-squared:  0.04482 
## F-statistic: 5.599 on 1 and 97 DF,  p-value: 0.01996
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ia_med_df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as.data.frame</span><span class="p">(</span><span class="n">resid</span><span class="p">(</span><span class="n">iaEduMod_med</span><span class="p">))</span><span class="w">
</span><span class="n">ia_med_df</span><span class="o">$</span><span class="n">county</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">plotSrc_med_ia</span><span class="o">$</span><span class="n">name</span><span class="w">
</span><span class="n">colnames</span><span class="p">(</span><span class="n">ia_med_df</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="w"> </span><span class="s2">"residual"</span><span class="p">,</span><span class="w"> </span><span class="s2">"county"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<h3 id="iowa-median-model-county-residuals">Iowa Median Model County Residuals</h3>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ia_med_df</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>##         residual        county
## 1  -0.0698771308         ADAIR
## 2  -0.0626695952         ADAMS
## 3  -0.0577524624     ALLAMAKEE
## 4  -0.0425195858     APPANOOSE
## 5  -0.0703218871       AUDUBON
## 6   0.0135565295        BENTON
## 7   0.0168034522    BLACK HAWK
## 8   0.0183828271         BOONE
## 9   0.0166698887        BREMER
## 10  0.0393247618      BUCHANAN
## 11  0.0876183606   BUENA VISTA
## 12 -0.0639751372        BUTLER
## 13  0.0068539027       CALHOUN
## 14 -0.0807633513       CARROLL
## 15  0.0240589330          CASS
## 16  0.0178388902         CEDAR
## 17  0.0205481719   CERRO GORDO
## 18  0.0012142122      CHEROKEE
## 19 -0.0586279740     CHICKASAW
## 20  0.0326358223        CLARKE
## 21  0.0875095949          CLAY
## 22 -0.0779393929       CLAYTON
## 23  0.0130968125       CLINTON
## 24 -0.0896821411      CRAWFORD
## 25  0.0067905428        DALLAS
## 26 -0.0489229649         DAVIS
## 27  0.0487135367       DECATUR
## 28 -0.0626068575      DELAWARE
## 29  0.0167590460    DES MOINES
## 30  0.0142671137     DICKINSON
## 31 -0.0653086956       DUBUQUE
## 32  0.0084627390         EMMET
## 33  0.0379903618       FAYETTE
## 34  0.0193618671         FLOYD
## 35  0.0102304642      FRANKLIN
## 36  0.0313653750       FREMONT
## 37  0.0089974723        GREENE
## 38  0.0144647967        GRUNDY
## 39  0.0279032762       GUTHRIE
## 40  0.0021000562      HAMILTON
## 41 -0.0890211419       HANCOCK
## 42  0.0154828035        HARDIN
## 43  0.0202798136      HARRISON
## 44  0.0247915724         HENRY
## 45 -0.0648661216        HOWARD
## 46  0.0007743202      HUMBOLDT
## 47  0.0078110812           IDA
## 48  0.0084270726          IOWA
## 49 -0.1111447334       JACKSON
## 50  0.0226355695        JASPER
## 51  0.0375409642     JEFFERSON
## 52  0.0178091783       JOHNSON
## 53 -0.0669817399         JONES
## 54  0.0338417038        KEOKUK
## 55 -0.0001827888       KOSSUTH
## 56  0.0275708975           LEE
## 57  0.1251309801          LINN
## 58  0.0104525307        LOUISA
## 59  0.0466248762         LUCAS
## 60 -0.1783359639 LYON/BUNCOMBE
## 61  0.0256228815       MADISON
## 62 -0.0621280035       MAHASKA
## 63 -0.0591260627        MARION
## 64  0.0109899381      MARSHALL
## 65  0.0186983518         MILLS
## 66  0.0217683251      MITCHELL
## 67  0.0002400920        MONONA
## 68  0.0518968927        MONROE
## 69  0.1055478112    MONTGOMERY
## 70 -0.0777806925     MUSCATINE
## 71  0.0042294249       O BRIEN
## 72 -0.0844676618       OSCEOLA
## 73  0.0227912237          PAGE
## 74  0.0126635703     PALO ALTO
## 75 -0.0917707364      PLYMOUTH
## 76 -0.0116855854    POCAHONTAS
## 77  0.1114975678          POLK
## 78  0.0099677272 POTTAWATTAMIE
## 79  0.0967193630     POWESHIEK
## 80  0.0373701459      RINGGOLD
## 81  0.0026975988           SAC
## 82  0.0035293703         SCOTT
## 83  0.0146905446        SHELBY
## 84 -0.1742005144         SIOUX
## 85  0.1005775055         STORY
## 86  0.0161494265          TAMA
## 87  0.0400091263        TAYLOR
## 88  0.0384390773         UNION
## 89  0.0414439818     VAN BUREN
## 90  0.0353212688       WAPELLO
## 91  0.1232005205        WARREN
## 92  0.0191529246    WASHINGTON
## 93  0.0420458200         WAYNE
## 94 -0.0061101406       WEBSTER
## 95  0.0212120364     WINNEBAGO
## 96 -0.1694246938    WINNESHIEK
## 97  0.0140698129      WOODBURY
## 98  0.0144878191         WORTH
## 99 -0.0015285639        WRIGHT
</code></pre></div></div>

<hr />

<h1 id="vam-regression">VAM REGRESSION<a id="vam-regression"></a></h1>

<h2 id="regressing-vam-on-logistic-params-for-years-1954-and-1958">Regressing VAM on Logistic Params for years 1954 and 1958</h2>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">params</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="s2">"Tractor_Raw_Data/TractorCoef.csv"</span><span class="p">)</span><span class="w">
</span><span class="n">vam</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="s2">"vamFipsData.csv"</span><span class="p">)</span><span class="w">
</span><span class="n">params</span><span class="p">[,</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NULL</span><span class="w">
</span><span class="n">vam</span><span class="p">[,</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NULL</span><span class="w">
</span></code></pre></div></div>

<h2 id="merge-params-df-and-vam-df">Merge params DF and vam DF</h2>

<p>INFO:</p>

<p>The dataset i’m using matches each county and year to their corresponding logistic params.(Slope, Ceiling, Mid)
Any counties with a Negative slope have been removed
Any counties with a ceiling &gt; 1 have been removed. 
Any counties with a midpoint before 1900 or after 1980 have been removed
Any counties with VAM as NA have been removed
Any counties with VAM as 0 have been removed</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#remove high ceilings</span><span class="w">
</span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">$</span><span class="n">Ceiling</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="p">]</span><span class="w">
</span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">$</span><span class="n">Mid</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">1940</span><span class="p">,]</span><span class="w">
</span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">$</span><span class="n">Mid</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">1960</span><span class="p">,]</span><span class="w">
</span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df</span><span class="p">[</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">VAM</span><span class="p">),]</span><span class="w">
</span><span class="c1">#Remove response variables that are 0</span><span class="w">
</span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df</span><span class="p">[</span><span class="n">which</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">VAM</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">),]</span><span class="w">
</span><span class="n">write.csv</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="s2">"filtered_df.csv"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>The next step necessary for fitting a logistic is to create a binary response</p>

<p>I’ve set the <code class="highlighter-rouge">response</code> as a binary value(1 = “Success”, 0 = “Failure”), this value was determined by wether a county had VAM of &gt; 250 or not. This is arbritary and can be played with to see if it changes the result.
I chose 250 b/c the range of VAM is (1,999) however majority of these values are below 500 so it seemed like a good starting point.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="o">$</span><span class="n">response</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ifelse</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">VAM</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="m">250</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>Before subsetting the data and get into modeling, I want to remove any N/A’s.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">unique</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">df</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>##     fips Slope Ceiling   Mid County.x State   VAM  year response
## 12 FALSE FALSE   FALSE FALSE    FALSE FALSE FALSE FALSE    FALSE
</code></pre></div></div>
<p>As seen above, none of the columns contain any N/A values</p>

<p>Below is a glimpse at the current dataset that will be used in the modeling. Next step is to reduce the observations to only rows that correspond to the years 1954 or 1958</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">head</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>##    fips     Slope   Ceiling      Mid       County.x State VAM year response
## 12 1009 0.2020403 0.9049963 1956.463         BLOUNT    AL  15 1929        0
## 13 1009 0.2020403 0.9049963 1956.463         BLOUNT    AL 140 1958        0
## 14 1009 0.2020403 0.9049963 1956.463         BLOUNT    AL  38 1947        0
## 21 1015 0.1737442 0.9187005 1953.665 CALHOUN/BENTON    AL 216 1929        0
## 22 1015 0.1737442 0.9187005 1953.665 CALHOUN/BENTON    AL 751 1958        1
## 23 1015 0.1737442 0.9187005 1953.665 CALHOUN/BENTON    AL 797 1954        1
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df.54</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="n">year</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1954</span><span class="p">)</span><span class="w">
</span><span class="n">rownames</span><span class="p">(</span><span class="n">df.54</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">nrow</span><span class="p">(</span><span class="n">df.54</span><span class="p">)</span><span class="w">
</span><span class="n">df.58</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="n">year</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1958</span><span class="p">)</span><span class="w">
</span><span class="n">rownames</span><span class="p">(</span><span class="n">df.58</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">nrow</span><span class="p">(</span><span class="n">df.58</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>Glimpse into 1954 dataset</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">head</span><span class="p">(</span><span class="n">df.54</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>##   fips     Slope   Ceiling      Mid       County.x State VAM year response
## 1 1015 0.1737442 0.9187005 1953.665 CALHOUN/BENTON    AL 797 1954        1
## 2 1043 0.2265686 0.8037223 1954.990        CULLMAN    AL  76 1954        0
## 3 1045 0.1738427 0.9419194 1956.008           DALE    AL 128 1954        0
## 4 1049 0.1862319 0.8949618 1956.816        DE KALB    AL 140 1954        0
## 5 1053 0.1624123 0.9736148 1957.202       ESCAMBIA    AL 298 1954        1
## 6 1061 0.2448450 0.8566386 1953.288         GENEVA    AL 244 1954        0
</code></pre></div></div>

<p>Glimpse into 1958 dataset</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">head</span><span class="p">(</span><span class="n">df.58</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>##   fips     Slope   Ceiling      Mid       County.x State VAM year response
## 1 1009 0.2020403 0.9049963 1956.463         BLOUNT    AL 140 1958        0
## 2 1015 0.1737442 0.9187005 1953.665 CALHOUN/BENTON    AL 751 1958        1
## 3 1019 0.1804967 0.8845261 1949.885       CHEROKEE    AL  86 1958        0
## 4 1043 0.2265686 0.8037223 1954.990        CULLMAN    AL 109 1958        0
## 5 1045 0.1738427 0.9419194 1956.008           DALE    AL 289 1958        1
## 6 1049 0.1862319 0.8949618 1956.816        DE KALB    AL 188 1958        0
</code></pre></div></div>

<p>#1954 Training and Test Set</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">smp_size</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">floor</span><span class="p">(</span><span class="m">.7</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">nrow</span><span class="p">(</span><span class="n">df.54</span><span class="p">))</span><span class="w">
</span><span class="n">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span><span class="w">
</span><span class="n">train_ind</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sample</span><span class="p">(</span><span class="nf">seq_len</span><span class="p">(</span><span class="n">nrow</span><span class="p">(</span><span class="n">df.54</span><span class="p">)),</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">smp_size</span><span class="p">)</span><span class="w">

</span><span class="n">df.54.train</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df.54</span><span class="p">[</span><span class="n">train_ind</span><span class="p">,]</span><span class="w">

</span><span class="n">df.54.test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df.54</span><span class="p">[</span><span class="o">-</span><span class="n">train_ind</span><span class="p">,]</span><span class="w">
</span></code></pre></div></div>

<h1 id="1954-model-wo-transformations-and-plots">1954 Model w/o Transformations and Plots</h1>

<p>Below are some exploratory plots containing the predictor features for year 1954.</p>

<p>The main one that I want to point out is [VAM vs. Slope], it seems counter-intuitive to me that as the slope increase for the county, the VAM is decreasing.</p>

<p>Maybe you have some other insight into this??</p>

<p><img src="2020-03-09-tractor_files/figure-html/54Model-1.png" alt="" /><!-- --><img src="2020-03-09-tractor_files/figure-html/54Model-2.png" alt="" /><!-- --><img src="2020-03-09-tractor_files/figure-html/54Model-3.png" alt="" /><!-- --></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## `geom_smooth()` using formula 'y ~ x'
</code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/54Model-4.png" alt="" /><!-- --></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>##        fips       Slope     Ceiling         Mid    County.x       State 
##   "integer"   "numeric"   "numeric"   "numeric" "character" "character" 
##         VAM        year    response 
##   "numeric"   "integer"   "numeric"
</code></pre></div></div>

<h1 id="54-model-summary">54 Model Summary</h1>

<p>Below is the actual modeling for year 1954 on training set</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">glm</span><span class="p">(</span><span class="n">response</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Slope</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Ceiling</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Mid</span><span class="p">,</span><span class="w">  </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df.54.train</span><span class="p">,</span><span class="w"> </span><span class="n">family</span><span class="o">=</span><span class="n">binomial</span><span class="p">(</span><span class="n">link</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"logit"</span><span class="p">))</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">model</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## 
## Call:
## glm(formula = response ~ Slope + Ceiling + Mid, family = binomial(link = "logit"), 
##     data = df.54.train)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.2309  -0.9268  -0.7328   1.2693   2.1178  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) 43.62342   35.72351   1.221    0.222    
## Slope       -8.05847    1.99785  -4.034 5.49e-05 ***
## Ceiling      1.69938    1.28813   1.319    0.187    
## Mid         -0.02283    0.01835  -1.244    0.213    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 796.35  on 629  degrees of freedom
## Residual deviance: 760.67  on 626  degrees of freedom
## AIC: 768.67
## 
## Number of Fisher Scoring iterations: 4
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">predicted.54</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">plogis</span><span class="p">(</span><span class="n">predict</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="w"> </span><span class="n">df.54.test</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<p>Looking at the model summary above ^, this tells me that as both slope and mid increase independent of one another, VAM will decrease. However, as the Ceiling parameter increases, VAM will increase with. I’m not sure how to interpret this, maybe to be discussed??</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] 0.2593
</code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-52-1.png" alt="" /><!-- --></p>

<p>This model is able to predict <code class="highlighter-rouge">Success</code> counties 30% of the time, doesn’t seem very good but at the same time we dont have much to work with</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#Sensitivity(Truth Detection Rate)</span><span class="w">
</span><span class="n">sensitivity</span><span class="p">(</span><span class="n">df.54.test</span><span class="o">$</span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="n">predicted.54</span><span class="p">,</span><span class="w"> </span><span class="n">threshold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">optCutOff</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] 0.1666667
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">confusionMatrix</span><span class="p">(</span><span class="n">df.54.test</span><span class="o">$</span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="n">predicted.54</span><span class="p">,</span><span class="w"> </span><span class="n">threshold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">optCutOff</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>##     0  1
## 0 187 65
## 1   5 13
</code></pre></div></div>

<h2 id="1954-model-w-transformations">1954 Model w/ Transformations</h2>

<p>Exploratory plots for predictor features log-transformed</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">trans54.df.train</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df.54.train</span><span class="w">
</span><span class="n">trans54.df.test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df.54.test</span><span class="w">
</span><span class="n">trans54.df.train</span><span class="o">$</span><span class="n">Ceiling</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">log</span><span class="p">(</span><span class="n">trans54.df.train</span><span class="o">$</span><span class="n">Ceiling</span><span class="p">)</span><span class="w">
</span><span class="n">trans54.df.test</span><span class="o">$</span><span class="n">Ceiling</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">log</span><span class="p">(</span><span class="n">trans54.df.test</span><span class="o">$</span><span class="n">Ceiling</span><span class="p">)</span><span class="w">
</span><span class="n">trans54.df.train</span><span class="o">$</span><span class="n">Slope</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">log</span><span class="p">(</span><span class="n">trans54.df.train</span><span class="o">$</span><span class="n">Slope</span><span class="p">)</span><span class="w">
</span><span class="n">trans54.df.test</span><span class="o">$</span><span class="n">Slope</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">log</span><span class="p">(</span><span class="n">trans54.df.test</span><span class="o">$</span><span class="n">Slope</span><span class="p">)</span><span class="w">


</span><span class="c1">#Plots for Transformed Predictors in Year 1954</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">trans54.df.train</span><span class="o">$</span><span class="n">Slope</span><span class="p">,</span><span class="w"> </span><span class="n">trans54.df.train</span><span class="o">$</span><span class="n">VAM</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"1954"</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Slope"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/1954Trans-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plot</span><span class="p">(</span><span class="n">trans54.df.train</span><span class="o">$</span><span class="n">Ceiling</span><span class="p">,</span><span class="w"> </span><span class="n">trans54.df.train</span><span class="o">$</span><span class="n">VAM</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"1954"</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Ceiling"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/1954Trans-2.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plot</span><span class="p">(</span><span class="n">trans54.df.train</span><span class="o">$</span><span class="n">Mid</span><span class="p">,</span><span class="w"> </span><span class="n">trans54.df.train</span><span class="o">$</span><span class="n">VAM</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"1954"</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Mid"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/1954Trans-3.png" alt="" /><!-- --></p>

<p>Modeling for transformed predicgtors for year 1954</p>

<p>We see below, same general results, VAM decreases with SLope and Mid but increases with Ceiling</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model.trans</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">glm</span><span class="p">(</span><span class="n">response</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Slope</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Ceiling</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Mid</span><span class="p">,</span><span class="w">  </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">trans54.df.train</span><span class="p">,</span><span class="w"> </span><span class="n">family</span><span class="o">=</span><span class="n">binomial</span><span class="p">(</span><span class="n">link</span><span class="o">=</span><span class="s2">"logit"</span><span class="p">))</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">model.trans</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## 
## Call:
## glm(formula = response ~ Slope + Ceiling + Mid, family = binomial(link = "logit"), 
##     data = trans54.df.train)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.3516  -0.9132  -0.7254   1.2635   2.0038  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) 37.96754   36.14104   1.051    0.293    
## Slope       -1.45589    0.34681  -4.198 2.69e-05 ***
## Ceiling      1.54351    1.07370   1.438    0.151    
## Mid         -0.02112    0.01848  -1.142    0.253    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 796.35  on 629  degrees of freedom
## Residual deviance: 760.55  on 626  degrees of freedom
## AIC: 768.55
## 
## Number of Fisher Scoring iterations: 4
</code></pre></div></div>

<p>Evaluating this transformed model’s goodness of fit below</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">predicted.54.trans</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">plogis</span><span class="p">(</span><span class="n">predict</span><span class="p">(</span><span class="n">model.trans</span><span class="p">,</span><span class="w"> </span><span class="n">trans54.df.test</span><span class="p">))</span><span class="w">

</span><span class="c1">#Find Optimal Prediction cutoff</span><span class="w">
</span><span class="n">optCutOff</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">optimalCutoff</span><span class="p">(</span><span class="n">trans54.df.test</span><span class="o">$</span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="n">predicted.54.trans</span><span class="p">)</span><span class="w">

</span><span class="c1">#Misclassification Error</span><span class="w">
</span><span class="n">misClassError</span><span class="p">(</span><span class="n">trans54.df.test</span><span class="o">$</span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="n">predicted.54.trans</span><span class="p">,</span><span class="w"> </span><span class="n">threshold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">optCutOff</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] 0.2704
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#ROC Curve</span><span class="w">
</span><span class="n">plotROC</span><span class="p">(</span><span class="n">trans54.df.test</span><span class="p">,</span><span class="w"> </span><span class="n">predicted.54.trans</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-55-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#Sensitivity(Truth Detection Rate)</span><span class="w">
</span><span class="n">sensitivity</span><span class="p">(</span><span class="n">trans54.df.test</span><span class="o">$</span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="n">predicted.54.trans</span><span class="p">,</span><span class="w"> </span><span class="n">threshold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">optCutOff</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] 0.1025641
</code></pre></div></div>
<p>The transformed model above is able to predict <code class="highlighter-rouge">Success</code> counties 21% of the time so this is worse than the non-transformed model</p>

<h2 id="1958">1958</h2>

<p>Model for year 1958 below</p>

<p>#1958 Training and Test Set</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">smp_size</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">floor</span><span class="p">(</span><span class="m">.7</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">nrow</span><span class="p">(</span><span class="n">df.58</span><span class="p">))</span><span class="w">
</span><span class="n">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span><span class="w">
</span><span class="n">train_ind</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sample</span><span class="p">(</span><span class="nf">seq_len</span><span class="p">(</span><span class="n">nrow</span><span class="p">(</span><span class="n">df.58</span><span class="p">)),</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">smp_size</span><span class="p">)</span><span class="w">

</span><span class="n">df.58.train</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df.58</span><span class="p">[</span><span class="n">train_ind</span><span class="p">,]</span><span class="w">

</span><span class="n">df.58.test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df.58</span><span class="p">[</span><span class="o">-</span><span class="n">train_ind</span><span class="p">,]</span><span class="w">
</span></code></pre></div></div>

<h1 id="exploratory-plots-for-year-1958">Exploratory plots for year 1958</h1>

<p><img src="2020-03-09-tractor_files/figure-html/58model-1.png" alt="" /><!-- --><img src="2020-03-09-tractor_files/figure-html/58model-2.png" alt="" /><!-- --><img src="2020-03-09-tractor_files/figure-html/58model-3.png" alt="" /><!-- --><img src="2020-03-09-tractor_files/figure-html/58model-4.png" alt="" /><!-- --></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## `geom_smooth()` using formula 'y ~ x'
</code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/58model-5.png" alt="" /><!-- --></p>

<h1 id="1958-modeling">1958 Modeling</h1>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">glm</span><span class="p">(</span><span class="n">response</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Slope</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Ceiling</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Mid</span><span class="p">,</span><span class="w">  </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df.58.train</span><span class="p">,</span><span class="w"> </span><span class="n">family</span><span class="o">=</span><span class="s2">"binomial"</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">model</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## 
## Call:
## glm(formula = response ~ Slope + Ceiling + Mid, family = "binomial", 
##     data = df.58.train)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.2986  -1.0471  -0.8424   1.2386   1.9531  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)   
## (Intercept) 27.75953   35.17439   0.789  0.43000   
## Slope       -5.27971    1.69721  -3.111  0.00187 **
## Ceiling      1.53451    1.21264   1.265  0.20572   
## Mid         -0.01466    0.01807  -0.811  0.41735   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 795.93  on 587  degrees of freedom
## Residual deviance: 774.04  on 584  degrees of freedom
## AIC: 782.04
## 
## Number of Fisher Scoring iterations: 4
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">predicted.58</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">plogis</span><span class="p">(</span><span class="n">predict</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="w"> </span><span class="n">df.58.test</span><span class="p">))</span><span class="w">

</span><span class="c1">#Find Optimal Prediction cutoff</span><span class="w">
</span><span class="n">optCutOff</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">optimalCutoff</span><span class="p">(</span><span class="n">df.58.test</span><span class="o">$</span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="n">predicted.58</span><span class="p">)</span><span class="w">

</span><span class="c1">#Misclassification Error</span><span class="w">
</span><span class="n">misClassError</span><span class="p">(</span><span class="n">df.58.test</span><span class="o">$</span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="n">predicted.58</span><span class="p">,</span><span class="w"> </span><span class="n">threshold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">optCutOff</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] 0.3597
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#ROC Curve</span><span class="w">
</span><span class="n">plotROC</span><span class="p">(</span><span class="n">df.58.test</span><span class="p">,</span><span class="w"> </span><span class="n">predicted.58</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-57-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#Sensitivity(Truth Detection Rate)</span><span class="w">
</span><span class="n">sensitivity</span><span class="p">(</span><span class="n">df.58.test</span><span class="o">$</span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="n">predicted.58</span><span class="p">,</span><span class="w"> </span><span class="n">threshold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">optCutOff</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] 0.3396226
</code></pre></div></div>

<p>Interestingly enough thoughm the 1958 model is able to predict <code class="highlighter-rouge">Success </code> counties 47% of the time, this is by far the best.</p>

<h1 id="midwestern-states-training-and-test">MidWestern States training and test</h1>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#Oh, MI, MN, IL, IN, WI </span><span class="w">
</span><span class="n">midWest</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="n">State</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"OH"</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">State</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"MI"</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">State</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"MN"</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">State</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"IL"</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">State</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"IN"</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">State</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"WI"</span><span class="p">)</span><span class="w">
</span><span class="n">smp_size</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">floor</span><span class="p">(</span><span class="m">.7</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">nrow</span><span class="p">(</span><span class="n">midWest</span><span class="p">))</span><span class="w">
</span><span class="n">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span><span class="w">
</span><span class="n">train_ind</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sample</span><span class="p">(</span><span class="nf">seq_len</span><span class="p">(</span><span class="n">nrow</span><span class="p">(</span><span class="n">midWest</span><span class="p">)),</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">smp_size</span><span class="p">)</span><span class="w">

</span><span class="n">midWest.train</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">midWest</span><span class="p">[</span><span class="n">train_ind</span><span class="p">,]</span><span class="w">

</span><span class="n">midWest.test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">midWest</span><span class="p">[</span><span class="o">-</span><span class="n">train_ind</span><span class="p">,]</span><span class="w">
</span></code></pre></div></div>

<p>Exploring only midwestern states</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#Plots for Transformed Predictors in Year 1954</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">midWest</span><span class="o">$</span><span class="n">Slope</span><span class="p">,</span><span class="w"> </span><span class="n">midWest</span><span class="o">$</span><span class="n">VAM</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-59-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plot</span><span class="p">(</span><span class="n">midWest</span><span class="o">$</span><span class="n">Ceiling</span><span class="p">,</span><span class="w"> </span><span class="n">midWest</span><span class="o">$</span><span class="n">VAM</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-59-2.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plot</span><span class="p">(</span><span class="n">midWest</span><span class="o">$</span><span class="n">Mid</span><span class="p">,</span><span class="w"> </span><span class="n">midWest</span><span class="o">$</span><span class="n">VAM</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-59-3.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#Response on X-Axis</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">midWest</span><span class="o">$</span><span class="n">VAM</span><span class="p">,</span><span class="w"> </span><span class="n">midWest</span><span class="o">$</span><span class="n">Ceiling</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-59-4.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model_midWest</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">glm</span><span class="p">(</span><span class="n">response</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Slope</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Ceiling</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Mid</span><span class="p">,</span><span class="w">  </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">midWest.train</span><span class="p">,</span><span class="w"> </span><span class="n">family</span><span class="o">=</span><span class="n">binomial</span><span class="p">(</span><span class="n">link</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"logit"</span><span class="p">))</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">model_midWest</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## 
## Call:
## glm(formula = response ~ Slope + Ceiling + Mid, family = binomial(link = "logit"), 
##     data = midWest.train)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.1438  -0.9978  -0.8943   1.3097   1.6475  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)  
## (Intercept) 144.32865   58.88672   2.451   0.0142 *
## Slope        -1.01061    2.66422  -0.379   0.7044  
## Ceiling      -0.53062    2.01071  -0.264   0.7919  
## Mid          -0.07411    0.03032  -2.444   0.0145 *
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 833.46  on 626  degrees of freedom
## Residual deviance: 824.64  on 623  degrees of freedom
## AIC: 832.64
## 
## Number of Fisher Scoring iterations: 4
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">predicted.midWest</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">plogis</span><span class="p">(</span><span class="n">predict</span><span class="p">(</span><span class="n">model_midWest</span><span class="p">,</span><span class="w"> </span><span class="n">midWest.test</span><span class="p">))</span><span class="w">

</span><span class="c1">#Find Optimal Prediction cutoff</span><span class="w">
</span><span class="n">optCutOff</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">optimalCutoff</span><span class="p">(</span><span class="n">midWest.test</span><span class="o">$</span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="n">predicted.midWest</span><span class="p">)</span><span class="w">

</span><span class="c1">#Misclassification Error</span><span class="w">
</span><span class="n">misClassError</span><span class="p">(</span><span class="n">midWest.test</span><span class="o">$</span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="n">predicted.midWest</span><span class="p">,</span><span class="w"> </span><span class="n">threshold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">optCutOff</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] 0.3815
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#ROC Curve</span><span class="w">
</span><span class="n">plotROC</span><span class="p">(</span><span class="n">midWest.test</span><span class="p">,</span><span class="w"> </span><span class="n">predicted.midWest</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/unnamed-chunk-59-5.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#Sensitivity(Truth Detection Rate)</span><span class="w">
</span><span class="n">sensitivity</span><span class="p">(</span><span class="n">midWest.test</span><span class="o">$</span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="n">predicted.midWest</span><span class="p">,</span><span class="w"> </span><span class="n">threshold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">optCutOff</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] 0.1724138
</code></pre></div></div>

<p>Midwest model is no good, 12% sucess in prediction, however there aren’t many observations so this was to be expected.</p>

<hr />

<h1 id="tractor-diffusion-region">Tractor Diffusion Region<a id="tractorregion"></a></h1>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## Parsed with column specification:
## cols(
##   X1 = col_double(),
##   stateAbb = col_character(),
##   percent = col_double(),
##   year = col_double()
## )
</code></pre></div></div>

<p><img src="2020-03-09-tractor_files/figure-html/regionDiff-1.png" alt="" /><!-- --><img src="2020-03-09-tractor_files/figure-html/regionDiff-2.png" alt="" /><!-- --><img src="2020-03-09-tractor_files/figure-html/regionDiff-3.png" alt="" /><!-- --></p>

<h1 id="visualize-diffusion-by-the-3-regions">Visualize diffusion by the 3 regions</h1>
<p><img src="2020-03-09-tractor_files/figure-html/regionRolledUpDiff-1.png" alt="" /><!-- --></p>

        
      </section>

      <footer class="page__meta">
        
        


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2020-11-05T00:00:00-05:00">November 5, 2020</time></p>
        
      </footer>

      

      
    </div>

    
  </article>

  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2020 Kyle Amyx. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script src="https://kit.fontawesome.com/4eee35f757.js"></script>















  </body>
</html>
